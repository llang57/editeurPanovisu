name: ðŸ“– GÃ©nÃ©rer et publier Javadoc

on:
  push:
    branches: [ master ]
    paths:
      - 'src/**/*.java'
      - '.github/workflows/javadoc.yml'
  workflow_dispatch:

permissions:
  contents: write

jobs:
  generate-javadoc:
    runs-on: ubuntu-latest
    
    steps:
    - name: ðŸ“¥ Checkout du code
      uses: actions/checkout@v4
    
    - name: â˜• Configuration Java 25
      uses: actions/setup-java@v4
      with:
        distribution: 'temurin'
        java-version: '25'
        cache: 'maven'
    
    - name: ðŸ“š GÃ©nÃ©rer Javadoc avec Maven
      run: |
        mvn javadoc:javadoc -DskipTests
        JAVADOC_DIR="target/reports/apidocs"
        mkdir -p javadoc-output
        cp -r "$JAVADOC_DIR"/* javadoc-output/
        touch javadoc-output/.nojekyll
    
    - name: ðŸš€ DÃ©ployer sur GitHub Pages (/javadoc/)
      uses: peaceiris/actions-gh-pages@v3
      with:
        github_token: ${{ secrets.GITHUB_TOKEN }}
        publish_dir: ./javadoc-output
        destination_dir: javadoc
        publish_branch: gh-pages
        keep_files: true
        commit_message: 'docs: ðŸ“– Mise Ã  jour Javadoc'
    
    - name: âœ… SuccÃ¨s
      run: |
        echo "âœ… Javadoc: https://llang57.github.io/editeurPanovisu/javadoc/"
        echo "ðŸ“š Doxygen: https://llang57.github.io/editeurPanovisu/"
