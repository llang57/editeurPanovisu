function estTactile(){return!!("ontouchstart"in window)}function panovisu(t){function e(){this.type="panoramique",this.long=0,this.lat=0,this.contenu="",this.image="",this.anime="false",this.info="",this.largeur="100%",this.position="center",this.couleur="rgba(0,0,0,0.7)"}function i(){this.image="",this.xml="",this.txt=""}function n(){this.image="",this.xml="",this.titre="",this.sousTitre="",this.select=""}function a(){this.positX=0,this.positY=0,this.xml="",this.texte=""}function o(){this.positX=0,this.positY=0,this.xml="",this.html="",this.image=""}function s(){this.fichier="",this.url="",this.infobulle="",this.posX="",this.posY="",this.offsetX=0,this.offsetY=0,this.opacite=1,this.tailleX="",this.tailleY="",this.masquable=!0}function r(){this.id="",this.alt="",this.title="",this.shape="",this.coords="",this.centerX=0,this.centerY=0}function c(){this.longitude=0,this.latitude=0,this.angleOuverture=0,this.angleradar=0,this.pcRayon=0,this.couleurLigne="",this.couleurFond="",this.opaciteFond=""}function p(t){switch(tr=0,er=0,id1=t.split("-"),t=id1[0]){case"xmoins":tr-=.5;break;case"xplus":tr+=.5;break;case"ymoins":er+=.5;break;case"yplus":er-=.5}}function u(){Qs+=1,E(),ti&&(Ke=requestAnimFrame(u))}function l(){Qs-=1,E(),ti&&(Ke=requestAnimFrame(l))}function d(){Math.abs(Je)<Math.abs(4*tr)&&(Je+=tr/5),Math.abs(Qe)<Math.abs(4*er)&&(Qe+=er/5),Ds+=Je,qs+=Qe,k(),ti&&(Ke=requestAnimFrame(d))}function h(){finX=!1,finY=!1,Math.round(10*Math.abs(Je))/10>0?Je-=tr/5:finX=!0,Math.round(10*Math.abs(Qe))/10>0?Qe-=er/5:finY=!0,Ds+=Je,qs+=Qe,k(),finX&&finY?cancelAnimationFrame(Ke):Ke=requestAnimFrame(h)}function g(){zs=1-zs,0===zs?($("#container-"+t).css("cursor","grab"),img=new Image,img.src="./panovisu/images/"+en+"/souris2.png",img.onload=function(){$("#souris-"+t+">img").attr("src",this.src)},img2=new Image,img2.src="./panovisu/images/telecommande/souris2.png",img2.onload=function(){$("#telSouris-"+t+">img").attr("src",this.src)}):($("#container-"+t).css("cursor","default"),img=new Image,img.src="./panovisu/images/"+en+"/souris.png",img.onload=function(){$("#souris-"+t+">img").attr("src",this.src)},img2=new Image,img2.src="./panovisu/images/telecommande/souris.png",img2.onload=function(){$("#telSouris-"+t+">img").attr("src",this.src)})}function f(){"oui"===na?(na="non",Ls=!1,An=!1,oe()):(na="oui",Ls=!0,ys=1/Rn,Ts=0,Ze=Date.now(),We=Ze,Ne=0,ae())}function m(){_n?$("#infoPanovisu-"+t).fadeOut(1e3,function(){$("#infoPanovisu-"+t).css({display:"none"}),_n=!1}):(gn?(img=new Image,img.src=fn,img.onload=function(){$("#infoPanovisu-"+t).html(""),larg=Math.round(this.width*mn/100),haut=Math.round(this.height*mn/100),$("<img>",{id:"infoImg-"+t,src:this.src,alt:"",height:haut,width:larg}).appendTo("#infoPanovisu-"+t),$("<a>",{id:"infoUrl-"+t,text:wn,href:bn,target:"_blank"}).appendTo("#infoPanovisu-"+t),$("#infoPanovisu-"+t).css({width:larg,height:haut}),$("#infoPanovisu-"+t).attr("title",chainesTraduction[mr].clicFenetre),posGauche=(ua.width()-$("#infoPanovisu-"+t).width())/2+$n,posHaut=(ua.height()-$("#infoPanovisu-"+t).height())/2+$n,$("#infoPanovisu-"+t).css({top:posHaut+"px",left:posGauche+"px",border:"none",backgroundColor:"rgba(255,255,255,0)",opacity:"1.0"}),topUrl=($("#infoPanovisu-"+t).height()-$("#infoUrl-"+t).height())/2+In,leftUrl=($("#infoPanovisu-"+t).width()-$("#infoUrl-"+t).width())/2+Pn,$("#infoUrl-"+t).css({color:Tn,fontSize:yn+"px",position:"absolute",top:topUrl+"px",left:leftUrl+"px"})}):(panoInfo=chainesTraduction[mr].fenetreInfo,$("#infoPanovisu-"+t).css({width:"450px",height:"190px"}),$("#infoPanovisu-"+t).html(panoInfo),posGauche=(ua.width()-$("#infoPanovisu-"+t).width())/2,posHaut=(ua.height()-$("#infoPanovisu-"+t).height())/2,$("#infoPanovisu-"+t).css({top:posHaut+"px",left:posGauche+"px"})),Un?($("#aidePanovisu-"+t).fadeOut(1e3,function(){Un=!1}),$("#infoPanovisu-"+t).fadeIn(1e3,function(){_n=!0})):$("#infoPanovisu-"+t).fadeIn(1e3,function(){_n=!0}))}function v(){Un?$("#aidePanovisu-"+t).fadeOut(1e3,function(){$("#aidePanovisu-"+t).css({display:"none"}),Un=!1}):_n?($("#infoPanovisu-"+t).fadeOut(1e3,function(){_n=!1}),$("#aidePanovisu-"+t).fadeIn(1e3,function(){Un=!0})):$("#aidePanovisu-"+t).fadeIn(1e3,function(){Un=!0})}function x(){if(ya){for("oui"===Ra&&($("#barre-"+t).fadeOut(500),$("#telec-"+t).fadeOut(500)),"oui"===Aa&&$("#boussole-"+t).fadeOut(500),"oui"===Ea&&$("#info-"+t).fadeOut(500),"oui"===Sa&&($("#plan-"+t).fadeOut(500),$("#planTitre-"+t).fadeOut(500),$("#carte-"+t).fadeOut(500),$("#carteTitre-"+t).fadeOut(500)),"oui"===Oa&&$("#reseauxSociaux-"+t).fadeOut(500),"oui"===Ya&&$("#comboMenu-"+t).fadeOut(500),"oui"===Ha&&Ji&&($("#divPrecedent-"+t).fadeOut(500),$("#divSuivant-"+t).fadeOut(500)),"oui"===Ca&&$(".hotSpots").fadeOut(500),"oui"===za&&($("#titreVignettes-"+t).fadeOut(500),$("#divVignettes-"+t).fadeOut(500),"left"===no&&$("#divPrecedent-"+t).css({left:0}),"right"===no&&$("#divSuivant-"+t).css({right:0})),Se=0;Cs>Se;Se++)Os[Se].masquable&&$("#imageFond-"+Se+"-"+t).fadeOut(500);ya=!1}else{if("oui"===Ra&&($("#barre-"+t).fadeIn(500),$("#telec-"+t).fadeIn(500)),"oui"===Aa&&$("#boussole-"+t).fadeIn(500),"oui"===Ea&&"oui"===Zn&&$("#info-"+t).fadeIn(500),"oui"===Sa&&(co&&($("#plan-"+t).fadeIn(500),$("#planTitre-"+t).fadeIn(500)),Lo&&($("#carte-"+t).fadeIn(500),$("#carteTitre-"+t).fadeIn(500))),"oui"===Oa&&$("#reseauxSociaux-"+t).fadeIn(500),"oui"===Ya&&$("#comboMenu-"+t).fadeIn(500),"oui"===Ha&&Ji&&($("#divPrecedent-"+t).fadeIn(500),$("#divSuivant-"+t).fadeIn(500)),"oui"===Ca&&$(".hotSpots").fadeIn(500),"oui"===za)if($("#titreVignettes-"+t).fadeIn(500),$("#divVignettes-"+t).fadeIn(500),ui)"left"===no&&$("#divPrecedent-"+t).css({left:0}),"right"===no&&$("#divSuivant-"+t).css({right:0});else{var e=$("#divVignettes-"+t).width()+6;"left"===no&&$("#divPrecedent-"+t).css({left:e}),"right"===no&&$("#divSuivant-"+t).css({right:e})}for(Se=0;Cs>Se;Se++)Os[Se].masquable&&$("#imageFond-"+Se+"-"+t).fadeIn(500);ya=!0}}function b(){if(ya){if("oui"===Ra&&($("#barre-"+t).show(),$("#telec-"+t).show()),"oui"===Aa&&$("#boussole-"+t).show(),"oui"===Ea&&"oui"===Zn&&$("#info-"+t).show(),"oui"===Sa&&(co&&($("#plan-"+t).show(),$("#planTitre-"+t).show()),Lo&&($("#carte-"+t).show(),$("#carteTitre-"+t).show())),"oui"===Oa&&$("#reseauxSociaux-"+t).show(),"oui"===Ya&&$("#comboMenu-"+t).show(),"oui"===Ha&&Ji&&($("#divPrecedent-"+t).show(),$("#divSuivant-"+t).show()),"oui"===Ca&&$(".hotSpots").show(),"oui"===za)if($("#titreVignettes-"+t).show(),$("#divVignettes-"+t).show(),ui)"left"===no&&$("#divPrecedent-"+t).css({left:0}),"right"===no&&$("#divSuivant-"+t).css({right:0});else{var e=$("#divVignettes-"+t).width()+6;"left"===no&&$("#divPrecedent-"+t).css({left:e}),"right"===no&&$("#divSuivant-"+t).css({right:e})}for(Se=0;Cs>Se;Se++)Os[Se].masquable&&$("#imageFond-"+Se+"-"+t).show()}else for("oui"===Ra&&($("#barre-"+t).hide(),$("#telec-"+t).hide()),"oui"===Aa&&$("#boussole-"+t).hide(),"oui"===Ea&&$("#info-"+t).hide(),"oui"===Sa&&($("#plan-"+t).hide(),$("#planTitre-"+t).hide(),$("#carte-"+t).hide(),$("#carteTitre-"+t).hide()),"oui"===Oa&&$("#reseauxSociaux-"+t).hide(),"oui"===Ya&&$("#comboMenu-"+t).hide(),"oui"===Ha&&Ji&&($("#divPrecedent-"+t).hide(),$("#divSuivant-"+t).hide()),"oui"===Ca&&$(".hotSpots").hide(),"oui"===za&&($("#titreVignettes-"+t).hide(),$("#divVignettes-"+t).hide(),"left"===no&&$("#divPrecedent-"+t).css({left:0}),"right"===no&&$("#divSuivant-"+t).css({right:0})),Se=0;Cs>Se;Se++)Os[Se].masquable&&$("#imageFond-"+Se+"-"+t).hide()}function w(){ri?($("#planTitre-"+t).css({transform:"translateX(-"+parseInt($("#planImg-"+t).width()+20)+"px) rotate(90deg)"}),$("#plan-"+t).css({transform:"translateX(-"+parseInt($("#planImg-"+t).width()+20)+"px)"})):($("#planTitre-"+t).css({transform:"translateX(0px)  rotate(90deg)"}),$("#plan-"+t).css({transform:"translateX(0px)"}))}function T(){ri?($("#planTitre-"+t).css({transform:"translateX("+parseInt($("#planImg-"+t).width()+20)+"px)  rotate(90deg)"}),$("#plan-"+t).css({transform:"translateX("+parseInt($("#planImg-"+t).width()+20)+"px)"})):($("#planTitre-"+t).css({transform:"translateX(0px)  rotate(90deg)"}),$("#plan-"+t).css({transform:"translateX(0px)"}))}function y(){ci?($("#carteTitre-"+t).css({transform:"translateX(-"+parseInt(Xo+20)+"px) rotate(90deg)"}),$("#carte-"+t).css({transform:"translateX(-"+parseInt(Xo+20)+"px)"})):($("#carteTitre-"+t).css({transform:"translateX(0px)  rotate(90deg)"}),$("#carte-"+t).css({transform:"translateX(0px)"}))}function P(){ci?($("#carteTitre-"+t).css({transform:"translateX("+parseInt(Xo+20)+"px)  rotate(90deg)"}),$("#carte-"+t).css({transform:"translateX("+parseInt(Xo+20)+"px)"})):($("#carteTitre-"+t).css({transform:"translateX(0px)  rotate(90deg)"}),$("#carte-"+t).css({transform:"translateX(0px)"}))}function I(){var e=ro+5;if(ui)switch(no){case"left":$("#divVignettes-"+t).css({transform:"translateX(-"+($("#divVignettes-"+t).width()+5)+"px)"}),$("#titreVignettes-"+t).css({transform:"translateX(-"+($("#divVignettes-"+t).width()+5)+"px) rotate(90deg)"}),dX1=parseInt(sa),$("#divPrecedent-"+t).css("left","0"),"left"===aa&&$("#barre-"+t).css("top"===oa?{left:dX1+$("#titreVignettes-"+t).height()+4+"px"}:{left:dX1+"px"}),dX1=parseInt(cs),"left"===ss&&$("#telec-"+t).css("top"===rs?{left:dX1+$("#titreVignettes-"+t).height()+4+"px"}:{left:dX1+"px"}),ha&&"left"===ma&&("top"===$a?$("#boussole-"+t).css(ma,parseInt(va)+$("#titreVignettes-"+t).height()+4+"px"):$("#boussole-"+t).css(ma,parseInt(va)+"px"));break;case"right":$("#divVignettes-"+t).css({transform:"translateX("+($("#divVignettes-"+t).width()+5)+"px)"}),$("#titreVignettes-"+t).css({transform:"translateX("+($("#divVignettes-"+t).width()+5)+"px) rotate(90deg)"}),dX1=parseInt(sa),$("#divSuivant-"+t).css("right","0"),"right"===aa&&$("#barre-"+t).css("top"===oa?{right:dX1+$("#titreVignettes-"+t).height()+4+"px"}:{right:dX1+"px"}),dX1=parseInt(cs),"right"===ss&&$("#telec-"+t).css("top"===rs?{right:dX1+$("#titreVignettes-"+t).height()+4+"px"}:{right:dX1+"px"}),ha&&"right"===ma&&("top"===$a?$("#boussole-"+t).css(ma,parseInt(va)+$("#titreVignettes-"+t).height()+4+"px"):$("#boussole-"+t).css(ma,parseInt(va)+"px")),"right"===aa&&$("#barre-"+t).css({right:dX1+"px"}),ha&&"right"===ma&&$("#boussole-"+t).css(ma,parseInt(va)+"px");break;case"bottom":$("#divVignettes-"+t).css({transform:"translateY("+($("#divVignettes-"+t).height()+5)+"px)"}),$("#titreVignettes-"+t).css({transform:"translateY("+($("#divVignettes-"+t).height()+5)+"px)"}),dY1=parseInt(ra),"bottom"===oa&&$("#barre-"+t).css("right"===aa?{top:-(35+dY1-2+$("#titreVignettes-"+t).height())+"px"}:{top:-(35+dY1-2)+"px"}),dY1=parseInt(ps),"bottom"===rs&&$("#telec-"+t).css("right"===ss?{bottom:dY1+$("#titreVignettes-"+t).height()+"px"}:{bottom:dY1+"px"}),ha&&"bottom"===$a&&("right"===ma?$("#boussole-"+t).css($a,parseInt(xa)+10+$("#titreVignettes-"+t).height()+"px"):$("#boussole-"+t).css($a,parseInt(xa)+10+"px"))}else switch(no){case"left":$("#divVignettes-"+t).css({transform:"translateX(0px)"}),$("#titreVignettes-"+t).css({transform:"rotate(90deg)"}),dX1=parseInt(sa)+e,$("#divPrecedent-"+t).css("left",e+6),$("#divPrecedent-"+t).css("left",e+6),dX1=parseInt(sa)+parseInt(ro)+5,"left"===aa&&$("#barre-"+t).css("top"===oa?{left:dX1+$("#titreVignettes-"+t).height()+4+"px"}:{left:dX1+"px"}),dX1=parseInt(cs)+parseInt(ro)+5,"left"===ss&&$("#telec-"+t).css("top"===rs?{left:dX1+$("#titreVignettes-"+t).height()+4+"px"}:{left:dX1+"px"}),ha&&"left"===ma&&("top"===$a?$("#boussole-"+t).css(ma,parseInt(va)+parseInt(ro)+5+$("#titreVignettes-"+t).height()+4+"px"):$("#boussole-"+t).css(ma,parseInt(va)+parseInt(ro)+5+"px"));break;case"right":$("#divVignettes-"+t).css({transform:"translateX(0px)"}),$("#titreVignettes-"+t).css({transform:"rotate(90deg)"}),dX1=parseInt(sa)+e,$("#divSuivant-"+t).css("right",e+6),"right"===aa&&$("#barre-"+t).css("top"===oa?{right:dX1+$("#titreVignettes-"+t).height()+4+"px"}:{right:dX1+"px"}),dX1=parseInt(cs)+e,$("#divSuivant-"+t).css("right",e+6),"right"===ss&&$("#telec-"+t).css("top"===rs?{right:dX1+$("#titreVignettes-"+t).height()+4+"px"}:{right:dX1+"px"}),ha&&"right"===ma&&("top"===$a?$("#boussole-"+t).css(ma,parseInt(va)+parseInt(ro)+5+$("#titreVignettes-"+t).height()+4+"px"):$("#boussole-"+t).css(ma,parseInt(va)+parseInt(ro)+5+"px"));break;case"bottom":$("#divVignettes-"+t).css({transform:"translateY(0px)"}),$("#titreVignettes-"+t).css({transform:"translateY(0px)"}),dY1=parseInt(ra)+$("#divVignettes-"+t).height()+5,"bottom"===oa&&$("#barre-"+t).css("right"===aa?{top:-(35+dY1-2+$("#titreVignettes-"+t).height())+0/0}:{top:-(35+dY1-2)+"px"}),dY1=parseInt(ps)+$("#divVignettes-"+t).height()+5,"bottom"===rs&&$("#telec-"+t).css("right"===ss?{bottom:dY1+$("#titreVignettes-"+t).height()+0/0}:{bottom:dY1+"px"}),"bottom"===no&&ha&&"bottom"===$a&&("right"===ma?$("#boussole-"+t).css($a,parseInt(xa)+parseInt(ro)/2+5+$("#titreVignettes-"+t).height()+10+"px"):$("#boussole-"+t).css($a,parseInt(xa)+parseInt(ro)/2+15+"px"))}Cs>0&&ie()}function L(){Ds+=ir,qs+=nr,k(),(Gs||bs)&&(Ke=requestAnimFrame(L))}function M(){bi="horizontales",$("#hautVignettes-"+t).hide(),$("#basVignettes-"+t).hide(),$("<div>",{id:"vignettes-"+t,"class":"vignettes"}).appendTo("#divVignettes-"+t);var e=ro/2,i=$("#pano1-"+t).width()-15;i<(ro+10)*Rs.length&&($("#gaucheVignettes-"+t).show(500),positVig=(ro/2-64)/2,$("#gaucheVignettes-"+t).css({left:0,bottom:positVig}),$("#droiteVignettes-"+t).show(500),$("#droiteVignettes-"+t).css({right:0,bottom:positVig})),$("#divVignettes-"+t).css(no,"0px"),$("#divVignettes-"+t).css({height:e,width:i,paddingLeft:"17px",paddingTop:"3px",paddingBottom:"3px",backgroundColor:ao,opacity:io,overflow:"hidden"}),paddingTitre=2,$("#titreVignettes-"+t).css({width:"80px",height:"30px",bottom:e+5,right:0,padding:paddingTitre+"px",paddingTop:"3px",backgroundColor:ao,color:oo,opacity:io,borderTopLeftRadius:"5px",borderTopRightRadius:"5px",textAlign:"center"}),$("#vignettes-"+t).css({height:e,width:3e3}),$("#divVignettes-"+t).css(no,"0px");for(var n=0;n<Rs.length;n++)texte=""!==Rs[n].txt?Rs[n].txt:Rs[n].xml,$("<img>",{id:"imgVig"+n+"-"+t,"class":"imgVignette",src:Rs[n].image,title:Rs[n].txt,width:ro,height:ro/2}).appendTo("#vignettes-"+t);"bottom"===no&&ha&&"bottom"===$a&&("right"===ma?$("#boussole-"+t).css($a,parseInt(xa)+parseInt(ro)/2+5+$("#titreVignettes-"+t).height()+2*paddingTitre+"px"):$("#boussole-"+t).css($a,parseInt(xa)+parseInt(ro)/2+15+"px")),$("#divVignettes-"+t).show(),$("#titreVignettes-"+t).show()}function V(){if(bi="verticales",$("#gaucheVignettes-"+t).hide(),$("#droiteVignettes-"+t).hide(),$("<div>",{id:"vignettes-"+t,"class":"vignettes"}).appendTo("#divVignettes-"+t),"oui"===Zn)var e=$("#pano1-"+t).height()-30-$("#info-"+t).height();else var e=$("#pano1-"+t).height()-30;var i=ro+5;topVignettes="4px",e<(ro/2+10)*(Rs.length+1)&&($("#hautVignettes-"+t).show(500),positVig=(ro-45)/2,$("#hautVignettes-"+t).css({left:positVig,top:0}),$("#basVignettes-"+t).show(500),$("#basVignettes-"+t).css({left:positVig,bottom:0}),topVignettes="17px"),$("#divVignettes-"+t).css(no,"0px"),$("#divVignettes-"+t).css({height:e-($("#info-"+t).height()-10)-22,width:i,paddingLeft:"3px",paddingTop:topVignettes,paddingRight:"3px",backgroundColor:ao,opacity:io,overflow:"hidden",top:$("#info-"+t).height()+10+"px"}),paddingTitre=2,$("#titreVignettes-"+t).css({width:"80px",height:"30px",top:$("#info-"+t).height()+10+"px",padding:paddingTitre+"px",paddingTop:"4px",backgroundColor:ao,color:oo,opacity:io,transformOrigin:"0% 0%",transform:"rotate(90deg)",textAlign:"center"}),"left"===no?($("#titreVignettes-"+t).css(no,i+5+2*paddingTitre+$("#titreVignettes-"+t).height()+"px"),$("#titreVignettes-"+t).css({borderTopLeftRadius:"5px",borderTopRightRadius:"5px"})):($("#titreVignettes-"+t).css(no,i+5-2*paddingTitre-$("#titreVignettes-"+t).width()+"px"),$("#titreVignettes-"+t).css({borderBottomLeftRadius:"5px",borderBottomRightRadius:"5px"})),$("#vignettes-"+t).css({height:3e3,width:i}),$("#divVignettes-"+t).css(no,"0px");for(var n=0;n<Rs.length;n++)texte=""!==Rs[n].txt?Rs[n].txt:Rs[n].xml,$("<img>",{id:"imgVig"+n+"-"+t,"class":"imgVignette",src:Rs[n].image,title:Rs[n].txt,width:ro,height:ro/2}).appendTo("#vignettes-"+t).css({marginBottom:"2px",marginTop:"2px",marginLeft:"0px",paddingRight:"0px"});$("#divVignettes-"+t).show(),$("#titreVignettes-"+t).show(),"right"===no&&($("#divSuivant-"+t).css("right",i+6),dX1=parseInt(sa)+parseInt(ro)+5,"right"===aa&&$("#barre-"+t).css("top"===oa?{right:dX1+$("#titreVignettes-"+t).height()+2*paddingTitre+"px"}:{right:dX1+"px"}),ha&&"right"===ma&&("top"===$a?$("#boussole-"+t).css(ma,parseInt(va)+parseInt(ro)+5+$("#titreVignettes-"+t).height()+2*paddingTitre+"px"):$("#boussole-"+t).css(ma,parseInt(va)+parseInt(ro)+5+"px"))),"left"===no&&($("#divPrecedent-"+t).css("left",i+6),dX1=parseInt(sa)+parseInt(ro)+5,"left"===aa&&$("#barre-"+t).css("top"===oa?{left:dX1+$("#titreVignettes-"+t).height()+2*paddingTitre+"px"}:{left:dX1+"px"}),ha&&"left"===ma&&("top"===$a?$("#boussole-"+t).css(ma,parseInt(va)+parseInt(ro)+5+$("#titreVignettes-"+t).height()+2*paddingTitre+"px"):$("#boussole-"+t).css(ma,parseInt(va)+parseInt(ro)+5+"px")))}function k(){pWidth=$("#"+li).width(),pHeight=$("#"+li).height(),hfov=1.5*Qs,"oui"===ia&&("oui"!==Ra||"oui"===Ra&&ya)&&$("#boutons-"+t).show(),"oui"===Zn&&("oui"!==Ea||"oui"===Ea&&ya)&&$("#info-"+t).show(),qs>89.99&&(qs=89.99),-90>qs&&(qs=-90),Ds%=360,de(),Ks=THREE.Math.degToRad(90-qs),Js=THREE.Math.degToRad(Ds),sr.x=500*Math.sin(Ks)*Math.cos(Js),sr.y=500*Math.cos(Ks),sr.z=500*Math.sin(Ks)*Math.sin(Js),Oe.lookAt(sr),gr&&Oe.position.copy(sr).negate(),He&&He.render(Ye,Oe);var e=Ds-da;if("oui"===Ta?$("#bousAig-"+t).css({transform:"rotate("+e+"deg)"}):$("#bousImg-"+t).css({transform:"rotate("+-e+"deg)"}),co&&bo){angleRadar=Qs/180*Math.PI/2;var i=document.getElementById("radar-"+t);if(i.getContext){var n=i.getContext("2d");n.clearRect(0,0,2*wo,2*wo),n.fillStyle=yo,n.strokeStyle=Po,n.strokeWidth=1,n.beginPath(),n.moveTo(wo,wo),n.arc(wo,wo,wo,-angleRadar,angleRadar,!1),n.lineTo(wo,wo),n.closePath(),n.fill(),n.stroke()}angleRadar=Ds-da+mo-90,$("#radar-"+t).css({transform:"rotate("+angleRadar+"deg)"})}Lo&&"oui"===Eo&&ke(-e+90,hfov),$(".data-title:before").css("content","PanoVisu "+version+" - "+programmeur+"("+anneeProgramme+")")}function F(e){var i=$("#pano1-"+t).width(),n=$("#pano1-"+t).height();posX=Math.round(.1*i),posY=Math.round(.1*n);var a=new Image;a.src=e,a.onload=function(){var o=a.height,s=a.width;ratio=s/o;var r=i-2*posX,c=r/ratio;c>n-2*posY?(o=n-2*posY,s=Math.round(o*ratio)):(s=i-2*posX,o=Math.round(s/ratio)),mrgX=Math.round((i-2*posX-s)/2)-20,mrgY=Math.round((n-2*posY-o)/2)-20,$("#divImage-"+t).html(""),$("#divImage-"+t).css({width:Math.round(i-2*posX)+"px",height:Math.round(n-2*posY)+"px",padding:posY+"px "+posX+"px",top:"0px",left:"0px",zIndex:10010,opacity:0,backgroundColor:En}),$("<img>",{id:"hsImg-"+t,"class":"hsImg",src:e,title:"",style:"background-color : #fff;padding : 20px;box-shadow: 10px 10px 20px 0px #656565;"}).appendTo("#divImage-"+t),$("#hsImg-"+t).css({width:s+"px",height:o+"px",marginTop:mrgY+"px",marginLeft:mrgX+"px"}),topCroix=n-o-posY-mrgY-15-40,rightCroix=i-s-posX-mrgX-15-40,$("<img>",{id:"imgFerme-"+t,"class":"imgFerme",src:"panovisu/images/fermer.png",style:"cursor : pointer;height :30px;width : 30px;position : absolute;top:"+topCroix+"px;right : "+rightCroix+"px;",title:"Cliquez pour quitter"}).appendTo("#divImage-"+t),$("#divImage-"+t).show(),$("#divImage-"+t).animate({opacity:1},1500)}}function X(e){url=Es[e].contenu;var i=$("#pano1-"+t).width(),n=$("#pano1-"+t).height();switch(posX=Math.round(.02*i),posY=Math.round(.02*n),$("#divHTML-"+t).html(""),$("#divHTML-"+t).css({width:i+"px",height:n+"px",top:"0px",left:"0px",zIndex:10010,opacity:0,backgroundColor:Es[e].couleur}),taille=parseInt(Es[e].largeur)>$("#divHTML-"+t).width()?$("#divHTML-"+t).width():parseInt(Es[e].largeur),$("<iframe>",{id:"ifHTML-"+t,"class":"hsHTML",src:url,style:"background-color : #fff;position : absolute;top :"+posY+"px;",height:Math.round(n-2*posY)+"px",width:taille}).appendTo("#divHTML-"+t),Es[e].position){case"left":case"right":$("#ifHTML-"+t).css(Es[e].position,"10px");break;case"center":posLeft=($("#divHTML-"+t).width()-taille)/2,$("#ifHTML-"+t).css("left",posLeft)}switch($("<img>",{id:"imgFerme-"+t,"class":"imgFerme",src:"panovisu/images/fermer.png",style:"height :30px;width : 30px;position : absolute;top : 0px;"}).appendTo("#divHTML-"+t),Es[e].position){case"left":$("#imgFerme-"+t).css(Es[e].position,taille-10+"px");break;case"right":$("#imgFerme-"+t).css(Es[e].position,"1px");break;case"center":$("#imgFerme-"+t).css("left",($("#divHTML-"+t).width()+taille)/2-20+"px")}$("#divHTML-"+t).show(),$("#divHTML-"+t).animate({opacity:1},1500)}function E(){Qs>ar&&(Qs=ar),or>Qs&&(Qs=or),Oe.fov=Qs,Oe.updateProjectionMatrix(),k()}function R(){var e=cs,i=ps;eo&&!ui&&("right"===no&&"right"===ss&&(e=e+parseInt(ro)+5),"left"===no&&"left"===ss&&(e=e+parseInt(ro)+5),"bottom"===no&&"bottom"===rs&&(i=i-2+parseInt(ro)/2+5)),"center"===ss&&$("#telec-"+t).css("left",(ua.width()-$("#telec-"+t).width())/2+cs+"px"),$("#telec-"+t).css(ss,e+"px"),$("#telec-"+t).css(rs,i+"px")}function A(e,i){$("#barre-"+t+" button").css({height:"30px",width:"30px",borderRadius:"3px",border:"1px solid "+Lr,backgroundColor:Ir}),$("#barre-"+t+" button img").css({height:"26px",width:"26px",paddingBottom:"0px",marginLeft:"0px"}),$("#barre-"+t).css({height:"40px"}),$("#button-"+t).show(),requestTimeout(function(){switch(w1=$("#barre-"+t).width(),h1=$("#barre-"+t).height(),dX1=parseInt(sa),dY1=parseInt(ra)-2,eo&&("right"!==no||"right"!==aa||ui||(dX1=parseInt(sa)+parseInt(ro)+5),"left"!==no||"left"!==aa||ui||(dX1=parseInt(sa)+parseInt(ro)+5),"bottom"!==no||"bottom"!==oa||ui||(dY1=parseInt(ra)-2+parseInt(ro)/2+5)),aa){case"left":$("#barre-"+t).css({left:dX1+"px"});break;case"center":posX=(e-w1)/2+dX1,$("#barre-"+t).css({left:posX+"px"});break;case"right":$("#barre-"+t).css({right:dX1+"px"})}switch(oa){case"top":posY=-(i-dY1),$("#barre-"+t).css({top:posY+"px"});break;case"center":posY=-(i+h1)/2-dY1,$("#barre-"+t).css({top:posY+"px"});break;case"bottom":$("#barre-"+t).css({top:-(35+dY1)+"px"})}},200)}function S(e){$("#container-"+t).fadeOut(200,function(){$e(Es[e].contenu)})}function O(){element=document.getElementById("panovisu-"+t);screenfull.enabled&&screenfull.toggle(element),requestTimeout(function(){ne()},300)}function Y(){gn?(img=new Image,img.src=fn,img.onload=function(){$("#infoPanovisu-"+t).html(""),larg=Math.round(this.width*mn/100),haut=Math.round(this.height*mn/100),$("<img>",{id:"infoImg-"+t,src:this.src,alt:"",height:haut,width:larg}).appendTo("#infoPanovisu-"+t),$("<a>",{id:"infoUrl-"+t,text:wn,href:bn,target:"_blank"}).appendTo("#infoPanovisu-"+t),$("#infoPanovisu-"+t).css({width:larg,height:haut}),$("#infoPanovisu-"+t).attr("title",chainesTraduction[mr].clicFenetre),posGauche=(ua.width()-$("#infoPanovisu-"+t).width())/2+$n,posHaut=(ua.height()-$("#infoPanovisu-"+t).height())/2+$n,$("#infoPanovisu-"+t).css({top:posHaut+"px",left:posGauche+"px",border:"none",backgroundColor:"rgba(255,255,255,0)",opacity:"1.0"}),topUrl=($("#infoPanovisu-"+t).height()-$("#infoUrl-"+t).height())/2+In,leftUrl=($("#infoPanovisu-"+t).width()-$("#infoUrl-"+t).width())/2+Pn,$("#infoUrl-"+t).css({color:Tn,fontSize:yn+"px",position:"absolute",top:topUrl+"px",left:leftUrl+"px"}),_n&&$("#infoPanovisu-"+t).css({display:"block"})}):(panoInfo=chainesTraduction[mr].fenetreInfo,$("#infoPanovisu-"+t).css({width:"450px",height:"190px"}),$("#infoPanovisu-"+t).html(panoInfo),posGauche=(ua.width()-$("#infoPanovisu-"+t).width())/2,posHaut=(ua.height()-$("#infoPanovisu-"+t).height())/2,$("#infoPanovisu-"+t).css({top:posHaut+"px",left:posGauche+"px"}),_n&&$("#infoPanovisu-"+t).css({display:"block"}))}function H(){Ln?(img=new Image,img.src=Mn,img.onload=function(){$("#aidePanovisu-"+t).html(""),larg=Math.round(this.width*Vn/100),haut=Math.round(this.height*Vn/100),$("<img>",{id:"infoImg-"+t,src:this.src,alt:"",height:haut,width:larg}).appendTo("#aidePanovisu-"+t),$("#aidePanovisu-"+t).css({width:larg,height:haut}),$("#aidePanovisu-"+t).attr("title",chainesTraduction[mr].clicFenetre),posGauche=(ua.width()-$("#aidePanovisu-"+t).width())/2+kn,posHaut=(ua.height()-$("#aidePanovisu-"+t).height())/2+kn,$("#aidePanovisu-"+t).css({top:posHaut+"px",left:posGauche+"px",border:"none",backgroundColor:"rgba(255,255,255,0)"}),Un&&$("#aidePanovisu-"+t).css({display:"block"})}):(panoInfo=chainesTraduction[mr].fenetreAide,$("#aidePanovisu-"+t).css({width:"400px",height:"220px"}),$("#aidePanovisu-"+t).html(panoInfo),posGauche=(ua.width()-$("#aidePanovisu-"+t).width())/2,posHaut=(ua.height()-$("#aidePanovisu-"+t).height())/2,$("#aidePanovisu-"+t).css({top:posHaut+"px",left:posGauche+"px"}),Un&&$("#aidePanovisu-"+t).css({display:"block"}))}function C(){panoInfo="<b>Panovisu version "+version+"</b><br><span style='color : red; font-weight : bold;'>Désolé votre navigateur ne supporte pas Webgl & Canvas</span><br>\n                Veuillez opter pour un navigateur plus récent<br>\n                Internet Explorer 10+ / Firefox / Chrome / Opéra / Safari<br><br>\n        &copy; Laurent LANG (2014)",$("#infoPanovisu-"+t).css({width:"450px",height:"150px"}),posGauche=(ua.width()-$("#infoPanovisu-"+t).width())/2,posHaut=(ua.height()-$("#infoPanovisu-"+t).height())/2,$("#infoPanovisu-"+t).css({top:posHaut+"px",left:posGauche+"px"}),$("#infoPanovisu-"+t).html(panoInfo)}function z(t,e,i,n){qs+=e,Qs+=n,1===e&&qs>t&&(qs=t),-1===e&&t>qs&&(qs=t),1===n&&Qs>i&&(Qs=i),-1===n&&i>Qs&&(Qs=i),(qs!==t||Qs!==i)&&(Oe=new THREE.PerspectiveCamera(Qs,ua.width()/ua.height(),1,1100),Oe.fov=Qs,Oe.updateProjectionMatrix(),k(),requestTimeout(function(){z(t,e,i,n),Gs=!1},5))}function D(t,e){sensLat=t>qs?1:-1,sensVisuel=e>Qs?1:-1,requestTimeout(function(){z(t,sensLat,e,sensVisuel)},5)}function q(e){if(ee(),(Bn||An)&&(null===Ps&&(Ps=ya),ya=!1,b()),Cs>0){for(u=0;Cs>u;u++)if($("<div>",{id:"imageFond-"+u+"-"+t,"class":"imgFond"}).appendTo("#panovisu-"+t),""!==Os[u].tailleX?$("<img>",{id:"imgFond-"+u+"-"+t,width:Os[u].tailleX,height:Os[u].tailleY,src:Os[u].fichier,title:Os[u].infobulle}).appendTo("#imageFond-"+u+"-"+t):$("<img>",{id:"imgFond-"+u+"-"+t,src:Os[u].fichier,title:Os[u].infobulle}).appendTo("#imageFond-"+u+"-"+t),$("#imgFond-"+u+"-"+t).css({opacity:Os[u].opacite,position:"absolute"}),""!==Os[u].url){var i=Os[u].url;$("#imgFond-"+u+"-"+t).css({cursor:"pointer",opacity:Os[u].opacite}),$("#imgFond-"+u+"-"+t).on("click",function(){window.open(i)})}ie()}if($(".barre button").css("margin-right",ea),ha){$("#boussole-"+t).css(ma,va+"px"),$("#boussole-"+t).css($a,xa+"px"),$("#boussole-"+t).css("opacity",wa),$("#boussole-"+t).css({width:fa+"px",height:fa+"px"}),$("#bousImg-"+t).attr("src","panovisu/images/boussoles/"+ga),$("#bousAig-"+t).attr("src","panovisu/images/boussoles/aiguille.png");var n=Math.round(parseInt(fa)/5),a=Math.round((parseInt(fa)-n)/2);$("#bousAig-"+t).css({position:"absolute",top:"0px",left:a+"px",width:n+"px",height:fa+"px"}),$("#bousImg-"+t).css({width:fa+"px",height:fa+"px",top:"0px",left:"0px"}),$("#boussole-"+t).show()}else $("#bousAig-"+t).hide(),$("#bousImg-"+t).hide();$("#divSuivant-"+t).hide(),$("#divPrecedent-"+t).hide(),Ci=""===Qi,zi=""===tn,""!==Qi&&Ji&&$("#divSuivant-"+t).show(),""!==tn&&Ji&&$("#divPrecedent-"+t).show(),Pa&&($("#marcheArret-"+t).css(Va,Fa+"px"),$("#marcheArret-"+t).css(ka,Xa+"px"),$("#marcheArret-"+t).css({width:Da+"px",height:Da+"px"}),$("#marcheArret-"+t).css("opacity",Ma),$("#MAImg-"+t).attr("src","panovisu/images/MA/"+La),$("#MAImg-"+t).css({width:Da+"px",height:Da+"px",top:"0px",left:"0px"}),$("#marcheArret-"+t).show()),qa?($(".RS").show(),$("#reseauxSociaux-"+t).css(ja,Ua+"px"),$("#reseauxSociaux-"+t).css(_a,Za+"px"),$("#reseauxSociaux-"+t).css({width:4*(Wa+5)-5+"px",height:Wa+"px"}),$("#reseauxSociaux-"+t).css("opacity",Ga),$("#RSTW-"+t).attr("src","panovisu/images/reseaux/twitter.png"),$("#RSGO-"+t).attr("src","panovisu/images/reseaux/google.png"),$("#RSFB-"+t).attr("src","panovisu/images/reseaux/facebook.png"),$("#RSEM-"+t).attr("src","panovisu/images/reseaux/email.png"),$("#RSTW-"+t+", #RSGO-"+t+", #RSFB-"+t+", #RSEM-"+t).css({width:Wa+"px",height:Wa+"px",top:"0px"}),"non"===Na&&$("#RSTW-"+t).hide(0),"non"===Ja&&$("#RSGO-"+t).hide(0),"non"===Ka&&$("#RSFB-"+t).hide(0),"non"===Qa&&$("#RSEM-"+t).hide(0),$("#reseauxSociaux-"+t).show()):$(".RS").hide(),$("#info-"+t).html(nn),"oui"===ia?$("#boutons-"+t).show():$("#boutons-"+t).hide(),"oui"===Kn?$("#deplacement-"+t).css({display:"inline-block"}):$("#deplacement-"+t).hide(),"oui"===Wn?$("#zoom-"+t).css({display:"inline-block"}):$("#zoom-"+t).hide(),"oui"===Nn?$("#outils-"+t).css({display:"inline-block"}):$("#outils-"+t).hide(),"oui"===Jn?$("#pleinEcran-"+t).show():$("#pleinEcran-"+t).hide(),"oui"===Qn?$("#auto-"+t).show():$("#auto-"+t).hide,"oui"===ta?$("#souris-"+t).show():$("#souris-"+t).hide(),"oui"===Zn?($("#info-"+t).show(),$("#info-"+t).css({top:"0px"})):$("#info-"+t).css({display:"none",height:"0px",top:"-1000px"}),hi="%"===vi?Math.round(mi*$("#"+li).parent().width()):mi,ee(),gi="%"===xi?Math.round($i*$("#"+li).parent().height()):$i,hi+="px",gi+="px",$("#"+e).width(hi),$("#"+e).height(gi),ua.width(hi),ua.height(gi),A(ua.width(),ua.height());var o=(gi-$("#divSuivant-"+t).height())/2;if($("#divSuivant-"+t).css("top",o),$("#divPrecedent-"+t).css("top",o),Y(),H(),eo&&("bottom"===no?M():V(),I()),co){if($("#plan-"+t).html(""),$("#plan-"+t).css(lo,"0px"),$("#plan-"+t).css({backgroundColor:ho,padding:"10px",top:"0px"}),$("<img>",{id:"planAig-"+t,"class":"planAig",src:"panovisu/images/plan/aiguillePlan.png"}).appendTo("#plan-"+t),bousX=$o.split(":")[1],bousY=$o.split(":")[0],$("#planAig-"+t).css(bousY,parseInt(xo+10)+"px"),imageObj=new Image,imageObj.src="panovisu/images/plan/aiguillePlan.png",$("#planAig-"+t).css(bousX,parseInt(vo+10+imageObj.height/2)+"px"),$("#planAig-"+t).css({transform:"rotate("+mo+"deg)"}),$("<img>",{id:"planImg-"+t,"class":"planImg",src:uo,width:po}).appendTo("#plan-"+t),"oui"===Zn)var s=$("#info-"+t).height()+10;else var s=0;$("#plan-"+t).css("top",s),$("<canvas>",{id:"radar-"+t,"class":"radar"}).appendTo("#plan-"+t),transformTitre=$("#planTitre-"+t).css("transform"),$("#planTitre-"+t).css({width:"160px",height:"30px",textAlign:"center",paddingLeft:"6px",transformOrigin:"0 0",borderTopLeftRadius:"3px",borderTopRightRadius:"3px",transform:"rotate(90deg)",backgroundColor:ho,color:go,top:s}),$("#planTitre-"+t).show(),$("#planTitre-"+t).html(chainesTraduction[mr].plan),"left"===lo?($("#planTitre-"+t).css(lo,$("#planImg-"+t).width()+20+$("#planTitre-"+t).height()+"px"),w()):($("#planTitre-"+t).css(lo,$("#planImg-"+t).width()+20-$("#planTitre-"+t).width()-parseInt($("#planTitre-"+t).css("paddingLeft"))+"px"),T()),$("#radar-"+t).attr("width",2*wo),$("#radar-"+t).attr("height",2*wo),$("#radar-"+t).css({transformOrigin:"50% 50%"});var r=Qs/180*Math.PI/2;if($("#radar-"+t).css({opacity:To}),bo){var c=document.getElementById("radar-"+t);if(c.getContext){var p=c.getContext("2d");p.fillStyle=yo,p.strokeStyle=Po,p.beginPath(),p.moveTo(wo,wo),p.arc(wo,wo,wo,-r,r,!1),p.lineTo(wo,wo),p.closePath(),p.fill(),p.stroke()}r=Ds-da+mo}for(var u=0;u<Ss.length;u++)"actif"===Ss[u].xml?($("<img>",{id:"planPt-"+u+"-"+t,"class":"planPoint actif",src:"panovisu/images/plan/pointActif.png",width:"12"}).appendTo("#plan-"+t),bo&&(ei=Ss[u].positX-wo+10,ii=Ss[u].positY-wo+10,$("#radar-"+t).css({top:ii,left:ei,transform:"rotate("+r+"deg)"}))):$("<img>",{id:"planPt-"+u+"-"+t,"class":"planPoint",title:Ss[u].texte,src:"panovisu/images/plan/point.png",width:"12"}).appendTo("#plan-"+t),$("#planPt-"+u+"-"+t).css({top:Ss[u].positY-$("#planPt-"+u+"-"+t).width()/2+10,left:Ss[u].positX-$("#planPt-"+u+"-"+t).width()/2+10});$("#plan-"+t).show(),$("#planTitre-"+t).show()}if(Lo){if(!ks){if($("#carte-"+t).html(""),$("#carte-"+t).css(Mo,"0px"),$("#carte-"+t).css({backgroundColor:Vo,padding:"10px",top:"0px",width:Xo+"px",height:Ho+"px"}),$("<div>",{id:"carteOL-"+t}).appendTo("#carte-"+t),$("#carteOL-"+t).css({padding:"0px",width:Xo+"px",height:Ho+"px"}),Me("carteOL-"+t),Ie(Bo),Pe(qo),"oui"===Zn)var l=$("#info-"+t).height()+10;
else var l=0;$("#carte-"+t).css("top",l),$("<img>",{id:"homeCarte-"+t,src:"panovisu/images/marqueursOL/home.png",style:"position : absolute;top :19px;left : 57px;width : 24px;height: 24px;z-index :1000000;cursor : pointer;"}).appendTo("#carte-"+t),transformTitre=$("#carteTitre-"+t).css("transform"),$("#carteTitre-"+t).css({width:"160px",height:"30px",textAlign:"center",paddingLeft:"6px",paddingTop:"3px",transformOrigin:"0 0",transform:"rotate(90deg)",backgroundColor:Vo,color:ko,top:l}),$("#carteTitre-"+t).show(),$("#carteTitre-"+t).html(chainesTraduction[mr].carte),"left"===Mo?($("#carteTitre-"+t).css(Mo,Xo+20+$("#carteTitre-"+t).height()+"px"),$("#carteTitre-"+t).css({borderTopLeftRadius:"5px",borderTopRightRadius:"5px"}),y()):($("#carteTitre-"+t).css(Mo,Xo+20-$("#carteTitre-"+t).width()-parseInt($("#carteTitre-"+t).css("paddingLeft"))+"px"),$("#carteTitre-"+t).css({borderBottomLeftRadius:"5px",borderBottomRightRadius:"5px"}),P()),"Google"===qo.substring(0,6)?xe(zo,Do,Co):xe(zo,Do,Co-10),$("#carte-"+t).show(),$("#carteTitre-"+t).show()}ye();for(var u=0;pi>u;u++)Te(u,Mr[u].positX,Mr[u].positY,Mr[u].html+"<br><img src='"+Mr[u].image+"' width='150' style='margin-left : 60px' />"),"actif"===Mr[u].xml&&"oui"===Eo&&Ve(Mr[u].positX,Mr[u].positY,45,45,Ro,Oo,So,Ao)}if(Sn){switch($("#btnVisiteAuto-"+t).html(""),An?$("<img>",{id:"imgBtnAutoTour-"+t,src:"panovisu/images/visiteAutomatique/pauseAutoTour.png",width:zn+"px"}).appendTo("#btnVisiteAuto-"+t):$("<img>",{id:"imgBtnAutoTour-"+t,src:"panovisu/images/visiteAutomatique/playAutoTour.png",width:zn+"px"}).appendTo("#btnVisiteAuto-"+t),$("#btnVisiteAuto-"+t).show(),On){case"left":case"right":$("#btnVisiteAuto-"+t).css(On,Hn+"px")}$("#btnVisiteAuto-"+t).css(Yn,Cn+"px")}I(),b(),fe(),R(),me()}function B(){null===Ps&&(Ps=ya),ya=!1,b(),_n&&requestTimeout(function(){$("#infoPanovisu-"+t).fadeOut(500,function(){$("#infoPanovisu-"+t).css({display:"none"}),_n=!1})},5e3),Sn&&($("#btnVisiteAuto-"+t).html(""),$("<img>",{id:"imgBtnAutoTour-"+t,src:"panovisu/images/visiteAutomatique/pauseAutoTour.png",alt:chainesTraduction[mr].arreteAutoTour,title:chainesTraduction[mr].arreteAutoTour,style:"cursor: pointer;width : "+zn+"px"}).appendTo("#btnVisiteAuto-"+t)),ys=1/Rn,Ts=0,Ze=Date.now(),We=Ze,Ne=0,ae()}function G(){ya=Ps,b(),oe(),Sn&&($("#btnVisiteAuto-"+t).html(""),$("<img>",{id:"imgBtnAutoTour-"+t,src:"panovisu/images/visiteAutomatique/playAutoTour.png",alt:chainesTraduction[mr].demarreAutoTour,title:chainesTraduction[mr].demarreAutoTour,style:"cursor: pointer;width : "+zn+"px"}).appendTo("#btnVisiteAuto-"+t))}function _(){if(!estTactile()){var e=new Array;for(Se=0;7>Se;Se++)e[Se]={};$.contextMenu("destroy"),Go&&(jo&&(e[0]={suiv:{name:chainesTraduction[mr].panoSuivant,disabled:function(){return Ci}},prec:{name:chainesTraduction[mr].panoPrecedent,disabled:function(){return zi}},sep1:"---------"}),_o&&(e[1]={little:{name:chainesTraduction[mr].petitePlanete,disabled:function(){return lr}},normal:{name:chainesTraduction[mr].vueNormale,disabled:function(){return dr}},sep2:"---------"}),Uo&&(e[2]={pers1:{name:Wo}},Zo&&(e[3]={pers2:{name:No}}),e[4]={sep3:"---------"}),e[5]={masqueTout:{name:function(){return""===hr&&(hr=chainesTraduction[mr].masqueElements),hr}},visiteAuto:{name:function(){return strVisiteAuto=An?chainesTraduction[mr].arreteAutoTour:chainesTraduction[mr].demarreAutoTour}},sep4:"---------"}),e[6]={lm360:{name:chainesTraduction[mr].panoVisuSite},apropos:{name:chainesTraduction[mr].aPropos}},items=$.extend(e[0],e[1],e[2],e[3],e[4],e[5],e[6]),$.contextMenu({selector:"#panovisu-"+t,appendTo:"#container-"+t,zIndex:15e3,build:function(){return{className:"data-title",position:function(e,i,n){e.$menu.css({top:n-$("#container-"+t).offset().top,left:i-$("#container-"+t).offset().left})},callback:function(e){switch(e){case"lm360":window.open("http://panovisu.fr");break;case"pers1":window.open(Ko);break;case"pers2":window.open(Jo);break;case"masqueTout":x(),hr=ya?chainesTraduction[mr].masqueElements:chainesTraduction[mr].afficheElements;break;case"visiteAuto":An?(An=!1,Ls=!1,G()):(An=!0,Ls=!0,B());break;case"suiv":$("#container-"+t).fadeOut(200,function(){$e(Qi)});break;case"prec":$("#container-"+t).fadeOut(200,function(){$e(tn)});break;case"apropos":_n?$("#infoPanovisu-"+t).fadeOut(1e3,function(){$("#infoPanovisu-"+t).css({display:"none"}),_n=!1}):(panoInfo=chainesTraduction[mr].fenetreInfo,$("#infoPanovisu-"+t).css({width:"450px",height:"190px"}),$("#infoPanovisu-"+t).html(panoInfo),posGauche=(ua.width()-$("#infoPanovisu-"+t).width())/2,posHaut=(ua.height()-$("#infoPanovisu-"+t).height())/2,$("#infoPanovisu-"+t).css({top:posHaut+"px",left:posGauche+"px"}),$("#infoPanovisu-"+t).css({backgroundColor:"#000",border:"1px solid white",opacity:"0.8"}),Un?($("#aidePanovisu-"+t).fadeOut(1e3,function(){Un=!1}),$("#infoPanovisu-"+t).fadeIn(1e3,function(){_n=!0})):$("#infoPanovisu-"+t).fadeIn(1e3,function(){_n=!0}));break;case"little":lr=!0,dr=!1,Ti=Qs,wi=ar,ar=170,gr=!0,D(-90,145);break;case"normal":lr=!1,dr=!0,ar=wi,gr=!1,D(0,Ti)}Gs=!1},items:items}}}),$(".data-title").attr("data-menutitle","PanoVisu "+version+" - "+programmeur+"("+anneeProgramme+")")}}function U(t,e){if(on>e){Ki=new THREE.TextureLoader;var i=Ni.split("/")[0]+"/niveau"+e+"/"+Ni.split("/")[1];Ki.load(i+".jpg",function(n){if(Ge++,ze[Ge]=n,ze[Ge].minFilter=THREE.LinearFilter,n.image.width<=ni){var a=i.split("/")[2],o=Ni.split("/")[1];if(a===o){Ms?(_e++,qe[_e]=new THREE.SphereGeometry(405-e,100,50)):(_e++,qe[_e]=new THREE.SphereGeometry(405-e,50,25)),Be++,Ce[Be]=new THREE.MeshBasicMaterial({map:n,overdraw:!0}),je++,De[je]=new THREE.Mesh(qe[_e],Ce[Be]),De[je].scale.x=-1,Ye.add(De[je]);for(var s=0,r=De[je].geometry.vertices.length;r>s;s++){var c=De[je].geometry.vertices[s];c.normalize(),c.multiplyScalar(550-e)}e+=1,U(t,e),k()}}})}else{Ki=new THREE.TextureLoader;var i=Ni;Ki.load(i+".jpg",function(t){if(Ge++,ze[Ge]=t,ze[Ge].minFilter=THREE.LinearFilter,t.image.width<=ni){var e=i.split("/")[1],n=Ni.split("/")[1];if(e===n){Ms?(_e++,qe[_e]=new THREE.SphereGeometry(390,100,50)):(_e++,qe[_e]=new THREE.SphereGeometry(390,50,25)),Be++,Ce[Be]=new THREE.MeshBasicMaterial({map:t,overdraw:!0}),je++,De[je]=new THREE.Mesh(qe[_e],Ce[Be]),De[je].scale.x=-1,Ye.add(De[je]);for(var a=0,o=De[je].geometry.vertices.length;o>a;a++){var s=De[je].geometry.vertices[a];s.normalize(),s.multiplyScalar(545)}k()}}})}}function Z(e,i,n,a,o,s){qs+=i,Ds+=a,Qs+=s,1===i&&qs>e&&(qs=e),-1===i&&e>qs&&(qs=e),1===a&&Ds>n&&(Ds=n),-1===a&&n>Ds&&(Ds=n),1===s&&Qs>o&&(Qs=o),-1===s&&o>Qs&&(Qs=o),qs!==e||Qs!==o||Ds!==n?(Oe=new THREE.PerspectiveCamera(Qs,ua.width()/ua.height(),1,1100),Oe.fov=Qs,Oe.updateProjectionMatrix(),k(),requestTimeout(function(){Z(e,i,n,a,o,s),Gs=!1},5)):(Oe=new THREE.PerspectiveCamera(Qs,ua.width()/ua.height(),1,1100),Oe.fov=Qs,Oe.updateProjectionMatrix(),gr=!1,Qs=Ti,ar=wi,Ds=Pi,qs=yi,ya=Ps,b(),k(),A(ua.width(),ua.height()),ee(),$("#container-"+t).fadeIn(200),"oui"===na&&(Ls=!0),tr=1,Je=0,ys=1/Rn,Ts=0,Ze=Date.now(),We=Ze,Ne=0,An?B():ae())}function W(t,e,i){sensLat=t>qs?1:-1,sensLon=e>Ds?1:-1,sensVisuel=i>Qs?1:-1,requestTimeout(function(){Z(t,sensLat,e,sensLon,i,sensVisuel)},5)}function N(){_(),Ti=Qs,wi=ar,yi=qs,Pi=Ds,ar=170,gr=!0,qs=-90,Qs=150,Oe=new THREE.PerspectiveCamera(Qs,ua.width()/ua.height(),1,1100),Oe.fov=Qs,Oe.updateProjectionMatrix(),k(),_n&&requestTimeout(function(){$("#infoPanovisu-"+t).fadeOut(500,function(){$("#infoPanovisu-"+t).css({display:"none"}),_n=!1})},4e3),requestTimeout(function(){W(yi,Pi,Ti)},8e3)}function K(){if(Fs){for(Se=1;je>=Se;Se++)Ye.remove(De[Se]);for(Se=1;Ge>=Se;Se++)ze[Se].dispose();for(Se=1;_e>=Se;Se++)qe[Se].dispose();for(Se=1;Be>=Se;Se++)Ce[Se].dispose()}if(Be=0,Ge=0,je=0,_e=0,Oe=new THREE.PerspectiveCamera(Qs,ua.width()/ua.height(),1,1100),Ye=new THREE.Scene,"oui"===an){Ki=new THREE.TextureLoader;var e=Ni.split("/")[0]+"/niveau0/"+Ni.split("/")[1];Ki.load(e+".jpg",function(e){if(Ge++,ze[Ge]=e,ze[Ge].minFilter=THREE.LinearFilter,Fs||(supportWebgl()?He=new THREE.WebGLRenderer:supportCanvas()?(He=new THREE.CanvasRenderer,Ms=!1):C()),Ms?(_e++,qe[_e]=new THREE.SphereGeometry(405,100,50)):(_e++,qe[_e]=new THREE.SphereGeometry(405,50,25)),Ms){var i=He.context;ni=i.getParameter(i.MAX_TEXTURE_SIZE),estTactile()&&(ni=4096)}else ni=4096;Be++,Ce[Be]=new THREE.MeshBasicMaterial({map:e,overdraw:!0}),je++,De[je]=new THREE.Mesh(qe[_e],Ce[Be]),De[je].scale.x=-1,Ye.add(De[je]);for(var n=0,a=De[je].geometry.vertices.length;a>n;n++){var o=De[je].geometry.vertices[n];o.normalize(),o.multiplyScalar(550)}U(Ni,1),He.setSize(ua.width(),ua.height()),pa.append(He.domElement);for(var n=0;n<Es.length;n++)ue(n);ai=setInterval(function(){de()},100),ne(),Bn?N():(k(),A(ua.width(),ua.height()),ee(),_(),$("#container-"+t).fadeIn(200),"oui"===na&&(Ls=!0),tr=1,Je=0,ys=1/Rn,Ts=0,Ze=Date.now(),We=Ze,Ne=0,An?B():ae())})}else Ki=new THREE.TextureLoader,Ki.load(Ni+".jpg",function(e){if(Ge++,ze[Ge]=e,ze[Ge].minFilter=THREE.LinearFilter,Fs||(supportWebgl()?He=new THREE.WebGLRenderer:supportCanvas()?(He=new THREE.CanvasRenderer,Ms=!1):C()),Ms){_e++,qe[_e]=new THREE.SphereGeometry(405,100,50);var i=He.context;ni=i.getParameter(i.MAX_TEXTURE_SIZE)}else _e++,qe[_e]=new THREE.SphereGeometry(405,50,25),ni=4096;Be++,Ce[Be]=new THREE.MeshBasicMaterial({map:e,overdraw:!0}),je++,De[je]=new THREE.Mesh(qe[_e],Ce[Be]),De[je].scale.x=-1,Ye.add(De[je]);for(var n=0,a=De[je].geometry.vertices.length;a>n;n++){var o=De[je].geometry.vertices[n];o.normalize(),o.multiplyScalar(550)}He.setSize(ua.width(),ua.height()),pa.append(He.domElement);for(var n=0;n<Es.length;n++)ue(n);ai=setInterval(function(){de()},50),ne(),Bn?N():(k(),A(ua.width(),ua.height()),ee(),_(),$("#container-"+t).fadeIn(200),"oui"===na&&(Ls=!0),tr=1,Je=0,ys=1/Rn,Ts=0,Ze=Date.now(),We=Ze,Ne=0,An?B():ae())})}function J(t,e){Ge++;var i=Ge;ze[i]=new THREE.Texture(di),ze[i].minFilter=THREE.LinearFilter,Be++,Ce[Be]=new THREE.MeshBasicMaterial({map:ze[i],overdraw:!0});var n=new Image;return n.onload=function(){var n=t.split("/")[2].split("_")[0],a=Ni.split("/")[1].split("_")[0];if(n===a){if(ze[i].image=this,ze[i].needsUpdate=!0,cr+=1,6>cr)$(".panovisuCharge").html(cr+"/6");else if($(".panovisuCharge").html("&nbsp;"),A(ua.width(),ua.height()),ee(),k(),"oui"===an&&on-1>e){cr=0,e+=1;var o=Ni.split("/")[0]+"/niveau"+e+"/"+Ni.split("/")[1],s=[J(o+"_r.jpg",e),J(o+"_l.jpg",e),J(o+"_u.jpg",e),J(o+"_d.jpg",e),J(o+"_f.jpg",e),J(o+"_b.jpg",e)];_e++,qe[_e]=new THREE.BoxGeometry(405+e,405+e,405+e,5,5,5),je>1&&(eff=je-1,De[eff].visible=!1),je++,De[je]=new THREE.Mesh(qe[_e],new THREE.MeshFaceMaterial(s)),De[je].scale.x=-1,Ye.add(De[je]);for(var r=0,c=De[je].geometry.vertices.length;c>r;r++){var p=De[je].geometry.vertices[r];p.normalize(),p.multiplyScalar(550-e)}}else{cr=0;var u=[Q(Ni+"_r.jpg"),Q(Ni+"_l.jpg"),Q(Ni+"_u.jpg"),Q(Ni+"_d.jpg"),Q(Ni+"_f.jpg"),Q(Ni+"_b.jpg")];_e++,qe[_e]=new THREE.BoxGeometry(415,415,415,40,40,40),je>1&&(eff=je-1,De[eff].visible=!1),je++,De[je]=new THREE.Mesh(qe[_e],new THREE.MeshFaceMaterial(u)),De[je].scale.x=-1,Ye.add(De[je]);for(var r=0,c=De[je].geometry.vertices.length;c>r;r++){var p=De[je].geometry.vertices[r];p.normalize(),p.multiplyScalar(550-e)}}ne(),k(),A(ua.width(),ua.height()),ee()}},n.src=t,Ce[Be]}function Q(t){Ge++;var e=Ge;ze[e]=new THREE.Texture(di),ze[e].minFilter=THREE.LinearFilter,Be++,Ce[Be]=new THREE.MeshBasicMaterial({map:ze[e],overdraw:!0});var i=new Image;return i.onload=function(){ze[e].image=this,ze[e].needsUpdate=!0,cr+=1,6>cr?$(".panovisuCharge").html(cr+"/6"):("oui"===an&&je>1&&(eff=je-1,De[eff].visible=!1),$(".panovisuCharge").html("&nbsp;"),A(ua.width(),ua.height()),ee()),ne(),k(),A(ua.width(),ua.height()),ee()},i.src=t,Ce[Be]}function te(){if(Fs){for(o=1;je>=o;o++)Ye.remove(De[o]);for(Ye.remove(ca),o=1;Ge>=o;o++)ze[o].dispose();for(o=1;_e>=o;o++)qe[o].dispose();for(o=1;Be>=o;o++)Ce[o].dispose()}if(Be=0,Ge=0,je=0,_e=0,$(".panovisuCharge").html("0/6"),Oe=new THREE.PerspectiveCamera(Qs,ua.width()/ua.height(),1,1100),Ye=new THREE.Scene,Ms=!1,!Fs){di=document.createElement("canvas"),di.width=128,di.height=128;var e=di.getContext("2d");e.fillStyle="rgb( 128, 128, 128 )",e.fillRect(0,0,di.width,di.height),supportWebgl()?(He=new THREE.WebGLRenderer,Ms=!0):supportCanvas()?He=new THREE.CanvasRenderer:C()}if(Ms){var i=He.context;ni=i.getParameter(i.MAX_TEXTURE_SIZE),estTactile()&&(ni=4096)}else ni=4096;if("oui"===an){var n=Ni.split("/")[0]+"/niveau0/"+Ni.split("/")[1],a=[J(n+"_r.jpg",0),J(n+"_l.jpg",0),J(n+"_u.jpg",0),J(n+"_d.jpg",0),J(n+"_f.jpg",0),J(n+"_b.jpg",0)];_e++,qe[_e]=new THREE.BoxGeometry(405,405,405,5,5,5),je++,De[je]=new THREE.Mesh(qe[_e],new THREE.MeshFaceMaterial(a))}else{cr=0;var a=[Q(Ni+"_r.jpg"),Q(Ni+"_l.jpg"),Q(Ni+"_u.jpg"),Q(Ni+"_d.jpg"),Q(Ni+"_f.jpg"),Q(Ni+"_b.jpg")];_e++,qe[_e]=new THREE.BoxGeometry(405,405,405,40,40,40),je++,De[je]=new THREE.Mesh(qe[_e],new THREE.MeshFaceMaterial(a))}De[je].scale.x=-1,Ye.add(De[je]);for(var o=0,s=De[je].geometry.vertices.length;s>o;o++){var r=De[je].geometry.vertices[o];r.normalize(),r.multiplyScalar(550)}He.setSize(ua.width(),ua.height()),pa.append(He.domElement),requestTimeout(function(){for(var e=0;e<Es.length;e++)ue(e);ne(),Bn?N():(k(),A(ua.width(),ua.height()),ee(),_(),ai=setInterval(function(){de()},50),$("#container-"+t).fadeIn(200),"oui"===na&&(Ls=!0),tr=1,Je=0,ys=1/Rn,Ts=0,Ze=Date.now(),We=Ze,Ne=0,An?B():ae())},1e3)}function ee(){if("oui"===Zn&&("oui"!==Ea||"oui"===Ea&&ya)){var e=ua.width(),i=pn;"%"===cn&&(i=(e-10)*pn),$("#info-"+t).css({fontFamily:"'"+sn+"',Verdana,Arial,sans-serif",fontSize:un,color:ln,opacite:1,backgroundColor:dn,width:i+"px",display:"block"});var i=pn;"%"===cn&&(i=e*pn),i=(e-i)/2,$("#info-"+t).css({marginLeft:i})}}function ie(){for(Se=0;Cs>Se;Se++){switch(Os[Se].posX){case"left":if(ui||"oui"!==to||"left"!==no)$("#imageFond-"+Se+"-"+t).css(Os[Se].posX,parseInt(Os[Se].offsetX)+"px");else{var e=parseInt(Os[Se].offsetX)+Math.round(ro)+10;$("#imageFond-"+Se+"-"+t).css(Os[Se].posX,e+"px")}$("#imgFond-"+Se+"-"+t).css(Os[Se].posX,"0px");break;case"right":if(ui||"oui"!==to||"right"!==no)$("#imageFond-"+Se+"-"+t).css(Os[Se].posX,Os[Se].offsetX+"px");else{var e=parseInt(Os[Se].offsetX)+Math.round(ro)+10;$("#imageFond-"+Se+"-"+t).css(Os[Se].posX,e+"px")}$("#imgFond-"+Se+"-"+t).css(Os[Se].posX,"0px");break;case"center":var i=($("#panovisu-"+t).width()-$("#imgFond-"+Se+"-"+t).width())/2+parseInt(Os[Se].offsetX);$("#imageFond-"+Se+"-"+t).css("left",i+"px")}if("middle"!==Os[Se].posY){if(ui||"oui"!==to||"bottom"!==no||"bottom"!==Os[Se].posY)$("#imageFond-"+Se+"-"+t).css(Os[Se].posY,Os[Se].offsetY+"px");else{var e=parseInt(Os[Se].offsetY)+Math.round(ro/2)+10;$("#imageFond-"+Se+"-"+t).css(Os[Se].posY,e+"px")}$("#imgFond-"+Se+"-"+t).css(Os[Se].posY,"0px")}else{var n=($("#panovisu-"+t).height()-$("#imgFond-"+Se+"-"+t).height())/2+parseInt(Os[Se].offsetY);$("#imageFond-"+Se+"-"+t).css("top",n+"px")}}}function ne(){if(rr){img=new Image;var e="./panovisu/images/"+en+"/fs2.png";img.src=e,img.onload=function(){$("#pleinEcran-"+t+">img").attr("src",this.src)},ts&&(e="./panovisu/images/telecommande/fs2.png",img.src=e,img.onload=function(){$("#telFS-"+t+">img").attr("src",this.src)}),hi=screen.width,gi=screen.height,ua.css({width:hi+"px",height:gi+"px"})}else{img=new Image;var e="./panovisu/images/"+en+"/fs.png";img.src=e,img.onload=function(){$("#pleinEcran-"+t+">img").attr("src",this.src)},ts&&(e="./panovisu/images/telecommande/fs.png",img.src=e,img.onload=function(){$("#telFS-"+t+">img").attr("src",this.src)}),hi="%"===vi?Math.round(mi*$("#"+li).parent().width()):mi,gi="%"===xi?Math.round($i*$("#"+li).parent().height()):$i,$("#"+li).css({width:hi+"px",height:gi+"px"}),ua.css({width:hi+"px",height:gi+"px"})}Oe.aspect=ua.width()/ua.height(),Oe.updateProjectionMatrix(),He&&He.setSize(ua.width(),ua.height()),k(),requestTimeout(function(){if(Y(),H(),A(ua.width(),ua.height()),ee(),Rs.length>0&&"horizontales"===bi){var e;e=rr?$("#pano1-"+t).width():$("#pano1-"+t).width()-15,$("#divVignettes-"+t).css({width:e}),$("#vignettes-"+t).css({transform:"translate(0px,0px)"});var i=(ro+10)*Rs.length;i>e?($("#gaucheVignettes-"+t).show(),$("#droiteVignettes-"+t).show()):($("#gaucheVignettes-"+t).hide(),$("#droiteVignettes-"+t).hide())}if(Rs.length>0&&"verticales"===bi){var n;if("oui"===Zn)var n=$("#pano1-"+t).height()-30-$("#info-"+t).height();else var n=$("#pano1-"+t).height()-30;$("#divVignettes-"+t).css({height:n}),$("#vignettes-"+t).css({transform:"translate(0px,0px)"});var i=(ro/2+10)*(Rs.length+1);i>n?($("#hautVignettes-"+t).show(),$("#basVignettes-"+t).show(),positVig=(ro-64)/2,$("#hautVignettes-"+t).css({left:positVig,top:0}),$("#basVignettes-"+t).css({left:positVig,bottom:0}),topVignette="17px",dHauteur=3):($("#hautVignettes-"+t).hide(),$("#basVignettes-"+t).hide(),topVignette="4px",dHauteur=20),$("#divVignettes-"+t).css({height:n+dHauteur,paddingTop:topVignette})}var a=(gi-$("#divSuivant-"+t).height())/2;$("#divSuivant-"+t).css("top",a),$("#divPrecedent-"+t).css("top",a),Cs>0&&ie(),R()},300)}function ae(){if(timer2=Date.now(),bFinPano=!1,dureeTotale=(timer2-We)/1e3,Gs||(temps=(timer2-Ze)/1e3,Ze=timer2,Math.abs(Ts)<Math.abs(ys)&&(Ts+=ys/60),Ds+=360*Ts*temps,qs=Math.max(-85,Math.min(85,qs)),Ne+=360*Ts*temps,k()),An){switch(Dn){case"tours":Ne>360*qn&&(bFinPano=!0);break;case"secondes":dureeTotale>qn&&(bFinPano=!0)}bFinPano&&(We=Date.now(),Ne=0,$e(Qi))}Ls&&!bFinPano&&requestAnimFrame(ae)}function oe(){finX=!1,Gs||(timer2=Date.now(),temps=(timer2-Ze)/1e3,Ze=timer2,Math.round(10*Math.abs(Ts))/10>0?Ts-=ys/60:finX=!0,Ds+=360*Ts*temps,k()),finX||requestAnimFrame(oe)}function se(){$("<button>",{type:"button",id:"xmoins-"+t,"class":"xmoins",title:chainesTraduction[mr].gauche,style:"background-color : "+Ir+";border : 1px solid "+Lr+";"}).appendTo("#deplacement-"+t),$("<button>",{type:"button",id:"ymoins-"+t,"class":"ymoins",title:chainesTraduction[mr].haut,style:"background-color : "+Ir+";border : 1px solid "+Lr+";"}).appendTo("#deplacement-"+t),$("<button>",{type:"button",id:"yplus-"+t,"class":"yplus",title:chainesTraduction[mr].bas,style:"background-color : "+Ir+";border : 1px solid "+Lr+";"}).appendTo("#deplacement-"+t),$("<button>",{type:"button",id:"xplus-"+t,"class":"xplus",title:chainesTraduction[mr].droite,style:"background-color : "+Ir+";border : 1px solid "+Lr+";"}).appendTo("#deplacement-"+t),$("<button>",{type:"button",id:"zoomPlus-"+t,"class":"zoomPlus",title:chainesTraduction[mr].zoomPlus,style:"background-color : "+Ir+";border : 1px solid "+Lr+";"}).appendTo("#zoom-"+t),$("<button>",{type:"button",id:"zoomMoins-"+t,"class":"zoomMoins",title:chainesTraduction[mr].zoomMoins,style:"background-color : "+Ir+";border : 1px solid "+Lr+";"}).appendTo("#zoom-"+t),$("<button>",{type:"button",id:"pleinEcran-"+t,"class":"pleinEcran",title:chainesTraduction[mr].pleinEcran,style:"background-color : "+Ir+";border : 1px solid "+Lr+";"}).appendTo("#outils-"+t),$("<button>",{type:"button",id:"souris-"+t,"class":"souris",title:chainesTraduction[mr].souris,style:"background-color : "+Ir+";border : 1px solid "+Lr+";"}).appendTo("#outils-"+t),$("<button>",{type:"button",id:"auto-"+t,"class":"auto",title:chainesTraduction[mr].autoratation,style:"background-color : "+Ir+";border : 1px solid "+Lr+";"}).appendTo("#outils-"+t),$("<button>",{type:"button",id:"binfo-"+t,"class":"binfo",title:chainesTraduction[mr].aPropos,style:"background-color : "+Ir+";border : 1px solid "+Lr+";"}).appendTo("#outils-"+t),$("<button>",{type:"button",id:"aide-"+t,"class":"aide",title:chainesTraduction[mr].aide,style:"background-color : "+Ir+";border : 1px solid "+Lr+";"}).appendTo("#outils-"+t)}function re(){"oui"===ia&&($("#xmoins-"+t).html(""),$("<img>",{src:"panovisu/images/"+en+"/gauche.png",alt:""}).appendTo("#xmoins-"+t),$("#ymoins-"+t).html(""),$("<img>",{src:"panovisu/images/"+en+"/haut.png",alt:""}).appendTo("#ymoins-"+t),$("#yplus-"+t).html(""),$("<img>",{src:"panovisu/images/"+en+"/bas.png",alt:""}).appendTo("#yplus-"+t),$("#xplus-"+t).html(""),$("<img>",{src:"panovisu/images/"+en+"/droite.png",alt:""}).appendTo("#xplus-"+t),$("#zoomPlus-"+t).html(""),$("<img>",{src:"panovisu/images/"+en+"/zoomin.png",alt:""}).appendTo("#zoomPlus-"+t),$("#zoomMoins-"+t).html(""),$("<img>",{src:"panovisu/images/"+en+"/zoomout.png",alt:""}).appendTo("#zoomMoins-"+t),$("#pleinEcran-"+t).html(""),$("<img>",{src:"panovisu/images/"+en+"/fs.png",alt:""}).appendTo("#pleinEcran-"+t),$("#souris-"+t).html(""),$("<img>",{src:"panovisu/images/"+en+"/souris.png",alt:""}).appendTo("#souris-"+t),$("#auto-"+t).html(""),$("<img>",{src:"panovisu/images/"+en+"/rotation.png",alt:""}).appendTo("#auto-"+t),$("#binfo-"+t).html(""),$("<img>",{src:"panovisu/images/"+en+"/info.png",alt:""}).appendTo("#binfo-"+t),$("#aide-"+t).html(""),$("<img>",{src:"panovisu/images/"+en+"/aide.png",alt:""}).appendTo("#aide-"+t))}function ce(e){$("<div>",{id:"infoPanovisu-"+t,"class":"infoPanovisu"}).appendTo("#"+e),$("#infoPanovisu-"+t).hide()}function pe(e){$("<div>",{id:"aidePanovisu-"+t,"class":"aidePanovisu"}).appendTo("#"+e),$("#aidePanovisu-"+t).hide()}function ue(e){$("<div>",{id:"HS-"+e+"-"+t,"class":"hotSpots"}).appendTo("#panovisu-"+t),$("<img>",{id:"imgHS-"+e+"-"+t,width:"30px",src:Es[e].image,title:Es[e].info}).appendTo("#HS-"+e+"-"+t),Vs+=1}function le(){for(var e=0;Vs>e;e++)$("#HS-"+e+"-"+t).html(),$("#HS-"+e+"-"+t).remove();Es=new Array,Vs=0}function de(){pHeight=$("#panovisu-"+t).height(),pWidth=$("#panovisu-"+t).width(),cLatitude=Math.cos(qs*vr),sLatitude=Math.sin(qs*vr),c1=-pHeight/Math.tan(Qs*Math.PI/360)/2;for(var e=0;Vs>e;e++)deltaLong=Ds%360-Es[e].long,cLat=Math.cos(Es[e].lat*vr),sLat=Math.sin(Es[e].lat*vr),cDeltaLong=Math.cos(deltaLong*vr),sDeltaLong=Math.sin(deltaLong*vr),denom=sLat*sLatitude+cLat*cLatitude*cDeltaLong,coef=c1/denom,("non"===Ca||"oui"===Ca&&ya)&&(0>cDeltaLong||gr?$("#HS-"+e+"-"+t).hide():($("#HS-"+e+"-"+t).show(),top1=coef*(sLat*cLatitude-cLat*sLatitude*cDeltaLong)+pHeight/2-15+"px",left1=coef*sDeltaLong*cLat+pWidth/2-15+"px",$("#HS-"+e+"-"+t).css({top:top1,left:left1})))}function he(c){xr=null,br=null,wr=null,Bs=c,Li=ri,Ii=ci,Mi=ui,Vi=Ls,ki=An,$.get(c,function(c){lr=!1,dr=!0,gr=!1;Ni="faces",Ir="none",en="classique",Lr="none",nn="",sn="Monospace",ln="#fff",un="13px",rn="50%",dn="#000",hn="1.0",En="rgba(0,0,0,0.8)",Gn="cube",jn="oui",_n=!0,Un=!1,Zn="oui",gn=!1,fn="",mn=100,$n=0,vn=0,xn=.8,bn="",wn="",Tn="#ffff00",yn=12,Pn=0,In=0,Ln=!1,Mn="",Vn=100,kn=0,Fn=0,Xn=.8,Wn="oui",Nn="oui",Kn="oui",Jn="oui",Qn="oui",ta="oui",ia="non",na="non",aa="center",oa="bottom",sa="0",ra="10",da=0,ha=!1,ga="rose2.png",fa="120",ma="right",$a="bottom",va="20",xa="20",ba="non",wa=.75,Ta="non",Pa=!1,Ia="non",Ma=.8,La="MAVert.png",Va="left",ka="bottom",Fa=10,Xa=10,Da=30,Ra="non",Ea="non",Aa="non",Sa="non",Oa="non",Ya="non",Ha="non",Ca="non",za="non",qa=!1,Ba="non",Ga=.8,ja="left",_a="bottom",Ua=0,Za=0,Wa=30,Na="non",Ka="non",Ja="non",Qa="non",to="non",eo=!1,an="non",on=0,Ji=!1,Cs=0,io=.8,no="bottom",ao="green",oo="yellow",ro=0,Rs=new Array,Es=new Array,As=new Array,gs="non",fs=!1,ms="top",$s="right",Rn=30,Ls=!1,An=!1,Sn=!1,On="right",Yn="top",Hn=10,Cn=10,zn=32,Dn="tours",qn=1,strARDemarrage="non",strATDemarrage="non",strPetitePlanete="non",strBtnAT="non",vs=10,xs=60,Ss=new Array,co=!1,uo="",po=0,mo=0,lo="left",ho="rgba(0,0,0,0.5)",fo=.8,go="white",$o="top:right",vo=0,xo=0,wo=50,To=.6,yo="rgb(128,128,128)",Po="rgb(200,200,0)",bo=!1,Io="non",Mo="right",Vo="#ff0000",ko="#ffff00",Fo=.7,Xo=400,Ho=300,Co=17,Eo="non",Ro=30,Ao=.4,So="#ff0000",Oo="#ffff00",zo=0,Do=0,qo="OpenStreetMap",Bo="",Mr=new Array,Go=!0,jo=!0,_o=!0,Uo=!1,Zo=!1,Wo="",No="",Ko="",Jo="",Qo="non",ts=!1,es="oui",is="oui",ns="oui",as="oui",os="oui",ss="bottom",rs="right",cs=0,ps=0,us=25,ls=40,ds="",hs="",$("#divVignettes-"+t).html(""),$("<img>",{id:"gaucheVignettes-"+t,"class":"positionVignettes",src:"panovisu/images/interface/gauche.png"}).appendTo("#divVignettes-"+t),$("<img>",{id:"droiteVignettes-"+t,"class":"positionVignettes",src:"panovisu/images/interface/droite.png"}).appendTo("#divVignettes-"+t),$("<img>",{id:"hautVignettes-"+t,"class":"positionVignettes",src:"panovisu/images/interface/haut.png"}).appendTo("#divVignettes-"+t),$("<img>",{id:"basVignettes-"+t,"class":"positionVignettes",src:"panovisu/images/interface/bas.png"}).appendTo("#divVignettes-"+t);var p=$(c).find("pano");Ni=p.attr("image")||Ni,nn=p.attr("titre")||nn,sn=p.attr("titrePolice")||sn,ln=p.attr("titreCouleur")||ln,rn=p.attr("titreTaille")||rn,un=p.attr("titreTaillePolice")||un,dn=p.attr("titreFond")||dn,hn=p.attr("titreOpacite")||hn,En=p.attr("diaporamaCouleur")||En,Gn=p.attr("type")||Gn,an=p.attr("multiReso")||an,on=parseInt(p.attr("nombreNiveaux"))||on,na=p.attr("rotation")||na,Ds=parseFloat(p.attr("regardX"))||Ds,qs=parseFloat(p.attr("regardY"))||qs,Qs=p.attr("champVision")||Qs,Zn=p.attr("afftitre")||Zn,jn=p.attr("affinfo")||jn,da=parseFloat(p.attr("zeroNord"))||da,strReplieVignettes=p.attr("replieVignettes")||"",ui="oui"===strReplieVignettes||ui,strRepliePlan=p.attr("repliePlan")||"",ri="oui"===strRepliePlan||ri,strReplieCarte=p.attr("replieCarte")||"",ci="oui"===strReplieCarte||ci,strARDemarrage=p.attr("autorotation")||"non",Ls="oui"===strARDemarrage,Rn=parseFloat(p.attr("vitesseAR"))||Rn,strATDemarrage=p.attr("autotour")||"non",An="oui"===strATDemarrage,strBtnAT=p.attr("atBouton")||"non",Sn="oui"===strBtnAT,zn=parseFloat(p.attr("atBoutonTaille"))||zn,On=p.attr("atBoutonPositionX")||On,Yn=p.attr("atBoutonPositionY")||Yn,Hn=parseFloat(p.attr("atBoutonOffsetX"))||Hn,Cn=parseFloat(p.attr("atBoutonOffsetY"))||Cn,qn=parseFloat(p.attr("limiteAT"))||qn,Dn=p.attr("typeAT")||Dn,An&&(Ls=!0),strPetitePlanete=p.attr("petitePlanete")||"non",Bn="oui"===strPetitePlanete,ks&&(Bn=!1,ui=Mi,ci=Ii,ri=Li,An=ki,Ls=Vi),Fs&&(jn=!1),_n="oui"===jn?!0:!1;var u=$(c).find("fenetreInfo");InfoAffiche=u.attr("affiche")||"non",gn="oui"===InfoAffiche,gn&&(fn=u.attr("image")||fn,mn=parseFloat(u.attr("taille"))||mn,$n=parseFloat(u.attr("dX"))||$n,vn=parseFloat(u.attr("dY"))||vn,xn=parseFloat(u.attr("opacite"))||xn,bn=u.attr("URL")||bn,wn=u.attr("texteURL")||wn,Tn=u.attr("couleurURL")||Tn,yn=parseFloat(u.attr("tailleURL"))||yn,Pn=parseFloat(u.attr("URLdX"))||Pn,In=parseFloat(u.attr("URLdY"))||In);var l=$(c).find("fenetreAide");AideAffiche=l.attr("affiche")||"non",Ln="oui"===AideAffiche,Ln&&(Mn=l.attr("image")||Mn,Vn=parseFloat(l.attr("taille"))||Vn,kn=parseFloat(l.attr("dX"))||kn,Fn=parseFloat(l.attr("dY"))||Fn,Xn=parseFloat(l.attr("opacite"))||Xn);var d=$(c).find("suivantPrecedent");Qi=d.attr("suivant")||"",tn=d.attr("precedent")||"",strAfficheSuivantPrecedent=d.attr("afficheSuivantPrecedent")||"non",Ji="oui"===strAfficheSuivantPrecedent;var h=$(c).find("boussole");ba=h.attr("affiche")||ba,ha="oui"===ba,ga=h.attr("image")||ga,fa=h.attr("taille")||fa,ma=h.attr("positionX")||ma,$a=h.attr("positionY")||$a,va=h.attr("dX")||va,xa=h.attr("dY")||xa,wa=parseFloat(h.attr("opacite"))||wa,Ta=h.attr("aiguille")||Ta;var g=$(c).find("menuContextuel");bMCAffiche=g.attr("affiche")||"non",Go="oui"===bMCAffiche,strPrecSuivMC=g.attr("precSuiv")||"oui",jo="oui"===strPrecSuivMC,strPlaneteMC=g.attr("planete")||"oui",_o="oui"===strPlaneteMC,strPersMC1=g.attr("pers1")||"non",Uo="oui"===strPersMC1,strPersMC2=g.attr("pers2")||"non",Zo="oui"===strPersMC2,Wo=g.attr("lib1")||Wo,No=g.attr("lib2")||No,Ko=g.attr("url1")||Ko,Jo=g.attr("url2")||Jo;var f=$(c).find("reseauxSociaux");Ba=f.attr("affiche")||Ba,qa="oui"===Ba,Ga=parseFloat(f.attr("opacite"))||Ga,ja=f.attr("positionX")||ja,_a=f.attr("positionY")||_a,Ua=parseFloat(f.attr("dX"))||Ua,Za=parseFloat(f.attr("dY"))||Za,Wa=parseFloat(f.attr("taille"))||Wa,Na=f.attr("twitter")||Na,Ka=f.attr("facebook")||Ka,Ja=f.attr("google")||Ja,Qa=f.attr("email")||Qa;var m=$(c).find("marcheArret");Ia=m.attr("affiche")||Ia,Pa="oui"===Ia,La=m.attr("image")||La,Ma=parseFloat(m.attr("opacite"))||Ma,Va=m.attr("positionX")||Va,ka=m.attr("positionY")||ka,Fa=parseFloat(m.attr("dX"))||Fa,Xa=parseFloat(m.attr("dY"))||Xa,Da=parseFloat(m.attr("taille"))||Da,Ra=m.attr("navigation")||Ra,Aa=m.attr("boussole")||Aa,Ea=m.attr("titre")||Ea,Sa=m.attr("plan")||Sa,Oa=m.attr("reseaux")||Oa,za=m.attr("vignettes")||za,Ya=m.attr("combo")||Ya,Ha=m.attr("suivPrec")||Ha,Ca=m.attr("hotspots")||Ca;var v=$(c).find("boutons");Kn=v.attr("deplacements")||Kn,en=v.attr("styleBoutons")||en,Wn=v.attr("zoom")||Wn,Nn=v.attr("outils")||Nn,ea=parseInt(v.attr("espacement"))-4||0,Jn=v.attr("fs")||Jn,Qn=v.attr("rotation")||Qn,ta=v.attr("souris")||ta,ia=v.attr("visible")||ia,aa=v.attr("positionX")||aa,oa=v.attr("positionY")||oa,Ir=v.attr("couleur")||Ir,Lr=v.attr("bordure")||Lr,$("#xmoins-"+t+",#xplus-"+t+",#ymoins-"+t+",#yplus-"+t+",#zoomPlus-"+t+",#zoomMoins-"+t+",#pleinEcran-"+t+",#souris-"+t+",#auto-"+t+",#binfo-"+t+",#aide-"+t).css({backgroundColor:Ir,border:"1px solid "+Lr}),sa=v.attr("dX")||sa,ra=v.attr("dY")||ra,Ys=new Array,Hs=new Array;var x=$(c).find("telecommande");Qo=x.attr("visible")||Qo,ts="oui"===Qo,es=x.attr("fs")||es,is=x.attr("rotation")||is,ns=x.attr("souris")||ns,as=x.attr("info")||ns,os=x.attr("aide")||ns,ss=x.attr("positionX")||ss,rs=x.attr("positionY")||rs,cs=parseFloat(x.attr("dX"))||cs,ps=parseFloat(x.attr("dY"))||ps,us=parseFloat(x.attr("taille"))||us,ls=parseFloat(x.attr("tailleBouton"))||ls,ds=x.attr("lien1")||ds,hs=x.attr("lien2")||hs,Se=0,j=0,$(c).find("zoneNavPerso").each(function(){if("area"===$(this).attr("id").substring(0,4)){var t=parseInt($(this).attr("id").substring(5,6));if(Hs[t]=new r,Hs[t].id=$(this).attr("id"),Hs[t].alt=$(this).attr("alt"),Hs[t].title=$(this).attr("title")||"",Hs[t].shape=$(this).attr("shape")||"",Hs[t].coords=$(this).attr("coords")||"",xmin=1500,ymin=1500,xmax=-1500,ymax=-1500,"poly"===Hs[t].shape||"rect"===Hs[t].shape)for(coord=Hs[t].coords.split(","),kk=0;kk<coord.length;kk+=2)parseFloat(coord[kk])<xmin&&(xmin=parseFloat(coord[kk])),parseFloat(coord[kk+1])<ymin&&(ymin=parseFloat(coord[kk+1])),parseFloat(coord[kk])>xmax&&(xmax=parseFloat(coord[kk])),parseFloat(coord[kk+1])>ymax&&(ymax=parseFloat(coord[kk+1])),Hs[t].centerX=(xmin+xmax)/2,Hs[t].centerY=(ymin+ymax)/2;else coord=Hs[t].coords.split(","),xmin=parseFloat(coord[0]),ymin=parseFloat(coord[1]),Hs[t].centerX=xmin,Hs[t].centerY=ymin;j++}else Ys[Se]=new r,Ys[Se].id=$(this).attr("id"),Ys[Se].alt=$(this).attr("alt"),Ys[Se].title=$(this).attr("title")||"",Ys[Se].shape=$(this).attr("shape")||"",Ys[Se].coords=$(this).attr("coords")||"",xmin=1500,ymin=1500,Se++}),le(),Se=0,$(c).find("point").each(function(){switch(Es[Se]=new e,Es[Se].type=$(this).attr("type")||Es[Se].type,Es[Se].type){case"panoramique":Es[Se].contenu=$(this).attr("xml");break;case"image":Es[Se].contenu=$(this).attr("img");break;case"html":Es[Se].contenu=$(this).attr("url")}Es[Se].info=$(this).attr("info")||"",Es[Se].image=$(this).attr("image")||"panovisu/images/sprite2.png",Es[Se].long=$(this).attr("long")||0,Es[Se].anime=$(this).attr("anime")||"false",Es[Se].lat=$(this).attr("lat")||0,Es[Se].largeur=$(this).attr("taille")||"100%",Es[Se].position=$(this).attr("position")||"center",Es[Se].couleur=$(this).attr("couleur")||"rgba(0,0,0,0.7)",Se++});var b=$(c).find("vignettes");to=b.attr("affiche")||to,eo="oui"===to,io=parseFloat(b.attr("opacite"))||io,no=b.attr("position")||no,ao=b.attr("fondCouleur")||ao,oo=b.attr("texteCouleur")||oo,so=parseFloat(b.attr("taille"))||so,ro=parseFloat(b.attr("tailleImage"))||ro,Se=0,$(c).find("imageVignette").each(function(){Rs[Se]=new i,Rs[Se].xml=$(this).attr("xml"),Rs[Se].image=$(this).attr("image"),Rs[Se].txt=$(this).attr("texte")||"",Se++});var w=$(c).find("comboMenu");gs=w.attr("affiche")||gs,fs="oui"===gs,ms=w.attr("positionX")||ms,$s=w.attr("positionY")||$s,vs=w.attr("dX")||vs,xs=w.attr("dY")||xs,Se=0,$(c).find("imageComboMenu").each(function(){As[Se]=new n,As[Se].xml=$(this).attr("xml"),As[Se].image=$(this).attr("image"),As[Se].titre=$(this).attr("titre")||"",As[Se].select=$(this).attr("selectionne")||"",As[Se].sousTitre=$(this).attr("sousTitre")||"",Se++}),Cs=0,Os=new Array,$(".imgFond").remove(),$(c).find("imageFond").each(function(){Os[Cs]=new s,Os[Cs].fichier=$(this).attr("fichier")||"",Os[Cs].url=$(this).attr("url")||"",Os[Cs].infobulle=$(this).attr("infobulle")||"",Os[Cs].tailleX=$(this).attr("tailleX")||"",Os[Cs].tailleY=$(this).attr("tailleY")||"",Os[Cs].posX=$(this).attr("posX")||"right",Os[Cs].posY=$(this).attr("posY")||"bottom",Os[Cs].offsetX=$(this).attr("offsetX")||0,Os[Cs].offsetY=$(this).attr("offsetY")||0,Os[Cs].opacite=$(this).attr("opacite")||0,Os[Cs].masquable="oui"===($(this).attr("masquable")||"oui"),Cs++
});var T=$(c).find("plan");planAff=T.attr("affiche")||"non",co="oui"===planAff,uo=T.attr("image")||uo,lo=T.attr("position")||lo,ho=T.attr("couleurFond")||ho,go=T.attr("couleurTexte")||go,fo=parseFloat(T.attr("opacitePlan"))||fo,po=parseFloat(T.attr("largeur"))||po,mo=parseFloat(T.attr("nord"))||mo,$o=T.attr("boussolePosition")||$o,vo=parseInt(T.attr("boussoleX"))||vo,xo=parseInt(T.attr("boussoleY"))||xo,afficheRadar=T.attr("radarAffiche")||"non",wo=parseInt(T.attr("radarTaille"))||wo,To=parseFloat(T.attr("radarOpacite"))||To,yo=T.attr("radarCouleurFond")||yo,Po=T.attr("radarCouleurLigne")||Po,bo="oui"===afficheRadar,Se=0,$(c).find("pointPlan").each(function(){Ss[Se]=new a,Ss[Se].xml=$(this).attr("xml"),Ss[Se].texte=$(this).attr("texte")||"",Ss[Se].positX=parseInt($(this).attr("positX"))||0,Ss[Se].positY=parseInt($(this).attr("positY"))||0,Se++});var y=$(c).find("carte");switch(Io=y.attr("affiche")||"non",Lo="oui"===Io,Mo=y.attr("position")||Mo,Vo=y.attr("couleurFond")||Vo,ko=y.attr("couleurTexte")||ko,Fo=parseFloat(y.attr("opaciteCarte"))||Fo,Xo=parseFloat(y.attr("largeur"))||Xo,Ho=parseFloat(y.attr("hauteur"))||Ho,Co=parseInt(y.attr("zoom"))||Co,zo=parseFloat(y.attr("coordCentreLong"))||zo,Do=parseFloat(y.attr("coordCentreLat"))||Do,qo=y.attr("nomLayer")||qo,Bo=y.attr("bingAPIKey")||Bo,Eo=y.attr("radarCarteAffiche")||"non",Ro=parseInt(y.attr("radarCarteTaille"))||Ro,Ao=parseFloat(y.attr("radarCarteOpacite"))||Ao,So=y.attr("radarCarteCouleurFond")||So,Oo=y.attr("radarCarteCouleurLigne")||Oo,Yo="oui"===Eo,Se=0,$(c).find("pointCarte").each(function(){Mr[Se]=new o,Mr[Se].xml=$(this).attr("xml"),Mr[Se].html=$(this).attr("html")||"",Mr[Se].image=$(this).attr("image")||"",Mr[Se].positX=parseFloat($(this).attr("positX"))||0,Mr[Se].positY=parseFloat($(this).attr("positY"))||0,Mr[Se].html=Mr[Se].html.replace("&gt;",">").replace("&lt;","<"),Se++}),pi=Se,rn.match("[px]","g")?(cn="px",pn=parseInt(rn)):(cn="%",pn=parseInt(rn)/100),q(li),re(),Gn){case"cube":te();break;case"sphere":K()}ne()})}function ge(e){var i="panovisu-"+t;$("<div>",{id:i,"class":"panovisu",style:"width : 100%;height : 100%;position: relative;"}).appendTo("#"+e),$("<div>",{id:"boussole-"+t,"class":"boussole"}).appendTo("#"+i),$("<img>",{id:"bousImg-"+t,"class":"bousImg",src:""}).appendTo("#boussole-"+t),$("<img>",{id:"bousAig-"+t,"class":"bousAig",src:""}).appendTo("#boussole-"+t),$("#boussole-"+t).hide(),$("<div>",{id:"marcheArret-"+t,"class":"marcheArret"}).appendTo("#"+i),$("<img>",{id:"MAImg-"+t,"class":"MAImg",src:"",title:chainesTraduction[mr].afficheMasque}).appendTo("#marcheArret-"+t),$("#marcheArret-"+t).hide(),$("<div>",{id:"reseauxSociaux-"+t,"class":"reseauxSociaux"}).appendTo("#"+i),$("<img>",{id:"RSTW-"+t,"class":"RS reseauSocial-twitter",src:"",title:"twitter"}).appendTo("#reseauxSociaux-"+t),$("<img>",{id:"RSGO-"+t,"class":"RS reseauSocial-google",src:"",title:"google"}).appendTo("#reseauxSociaux-"+t),$("<img>",{id:"RSFB-"+t,"class":"RS reseauSocial-fb",src:"",title:"facebook"}).appendTo("#reseauxSociaux-"+t),$("<a>",{id:"lienEmail"+t,"class":"RS reseauSocial-email",href:""}).appendTo("#reseauxSociaux-"+t),$("<img>",{id:"RSEM-"+t,src:"",title:"email"}).appendTo("#lienEmail"+t),$("#reseauxSociaux-"+t).hide(),$("<div>",{id:"info-"+t,"class":"info"}).appendTo("#"+i),$("<div>",{id:"infoBulle-"+t,"class":"infoBulle",style:"display:none;position: absolute;"}).appendTo("#"+i),$("#infoBulle-"+t).html("infoBulle"),$("<div>",{id:"pano1-"+t,"class":"pano1"}).appendTo("#"+i),$("<div>",{id:"container-"+t,"class":"container",style:"z-index:10000"}).appendTo("#pano1-"+t),$("<div>",{id:"divVignettes-"+t,"class":"vignettes"}).appendTo("#pano1-"+t),$("<div>",{id:"titreVignettes-"+t,"class":"titreVignettes"}).appendTo("#pano1-"+t),$("#titreVignettes-"+t).html(chainesTraduction[mr].vignettes),$("#divVignettes-"+t).hide(),$("#titreVignettes-"+t).hide(),$("<div>",{id:"divImage-"+t,"class":"vignettes"}).appendTo("#pano1-"+t),$("#divImage-"+t).hide(),$("<div>",{id:"divHTML-"+t,"class":"vignettes"}).appendTo("#pano1-"+t),$("#divHTML-"+t).hide(),$("<div>",{id:"divPrecedent-"+t,"class":"precedent",title:chainesTraduction[mr].panoPrecedent}).appendTo("#pano1-"+t),$("<div>",{id:"divSuivant-"+t,"class":"suivant",title:chainesTraduction[mr].panoSuivant}).appendTo("#pano1-"+t),$("#divPrecedent-"+t).hide(),$("#divSuivant-"+t).hide(),$("<div>",{id:"btnVisiteAuto-"+t,"class":"btnVisiteAuto"}).appendTo("#"+i),ri=!1,ci=!1,ui=!0,$("<div>",{id:"telec-"+t,"class":"telecommande"}).appendTo("#"+i),$("<div>",{id:"comboMenu-"+t,"class":"comboMenu"}).appendTo("#"+i),$("<div>",{id:"boutons-"+t,"class":"boutons"}).appendTo("#"+i),$("<div>",{id:"barre-"+t,"class":"barre"}).appendTo("#boutons-"+t),$("<div>",{id:"deplacement-"+t,"class":"deplacement"}).appendTo("#barre-"+t),$("<div>",{id:"zoom-"+t,"class":"zoom"}).appendTo("#barre-"+t),$("<div>",{id:"outils-"+t,"class":"outils"}).appendTo("#barre-"+t),$("<div>",{id:"plan-"+t,"class":"plan"}).appendTo("#pano1-"+t),$("<div>",{id:"planTitre-"+t,"class":"planTitre"}).appendTo("#pano1-"+t),$("#plan-"+t).hide(),$("#planTitre-"+t).hide(),$("#planTitre-"+t).css("transform","rotate(90deg)"),$("<div>",{id:"carte-"+t,"class":"carte"}).appendTo("#pano1-"+t),$("<div>",{id:"carteTitre-"+t,"class":"carteTitre"}).appendTo("#pano1-"+t),$("#carte-"+t).hide(),$("#carteTitre-"+t).hide(),$("#carteTitre-"+t).css("transform","rotate(90deg)"),se(),ce(i),pe(i),pa=$("#container-"+t),ua=$("#"+i),la=$("#pano1-"+t),Ue=document.getElementById("container-"+t),$(document).on("touchstart","#marcheArret-"+t,function(t){t.preventDefault(),x()}),Ue.addEventListener("touchstart",function(e){e.preventDefault(),1===e.targetTouches.length&&(_n&&$("#infoPanovisu-"+t).fadeOut(2e3,function(){$(this).css({display:"none"}),_n=!1}),bs=!0,js=e.touches[0].pageX,_s=e.touches[0].pageY,1===zs?(ir=0,nr=0,Ke=requestAnimFrame(L)):(Ws=Ds,Ns=qs)),2===e.targetTouches.length&&(_n&&$("#infoPanovisu-"+t).fadeOut(2e3,function(){$(this).css({display:"none"}),_n=!1}),onPointerDownPointerX1=e.touches[0].pageX,onPointerDownPointerY1=e.touches[0].pageY,onPointerDownPointerX2=e.touches[1].pageX,onPointerDownPointerY2=e.touches[1].pageY,tr=onPointerDownPointerX1-onPointerDownPointerX2,er=onPointerDownPointerY1-onPointerDownPointerY2,Zs=tr*tr+er*er,ws=!0,Us=Qs)},!1),Ue.addEventListener("touchmove",function(t){t.preventDefault(),bs?2===t.targetTouches.length?(bs=!1,onPointerDownPointerX1=t.touches[0].pageX,onPointerDownPointerY1=t.touches[0].pageY,onPointerDownPointerX2=t.touches[1].pageX,onPointerDownPointerY2=t.touches[1].pageY,tr=onPointerDownPointerX1-onPointerDownPointerX2,er=onPointerDownPointerY1-onPointerDownPointerY2,Zs=tr*tr+er*er,ws=!0,Us=Qs):1===zs?(ir=.01*-(js-t.touches[0].pageX),nr=.01*(_s-t.touches[0].pageY)):(si=!0,Ds=.1*(js-t.touches[0].pageX)+Ws,qs=.1*(t.touches[0].pageY-_s)+Ns,k()):ws&&(onPointerDownPointerXX1=t.touches[0].pageX,onPointerDownPointerYY1=t.touches[0].pageY,onPointerDownPointerXX2=t.touches[1].pageX,onPointerDownPointerYY2=t.touches[1].pageY,tr=onPointerDownPointerXX1-onPointerDownPointerXX2,er=onPointerDownPointerYY1-onPointerDownPointerYY2,distance2=tr*tr+er*er,dZ=Zs/distance2,Qs=Us*Math.pow(dZ,.25),ws=!0,E())},!1),Ue.addEventListener("touchend",function(){1===zs&&(Je=ir,Qe=nr,tr=ir/4,er=nr/4,Ke=requestAnimFrame(h)),bs=!1,ws=!1},!1)}function fe(){ks||($("#telec-"+t).html(""),ts&&(img=new Image,img.src="panovisu/images/telecommande/telecommande.png",img.onload=function(){$("#telec-"+t).css({width:this.width,height:this.height}),$("<img>",{id:"telecommande-"+t,"class":"imgTelec",src:this.src,border:"0",width:this.width,height:this.height,usemap:"#telecommandeMap-"+t,alt:""}).appendTo("#telec-"+t);var e=ls,i=0,n=1;for("oui"===as&&(Hs[n]&&(xm1=Hs[n].centerX-e/2-i,ym1=Hs[n].centerY-e/2-i,$("<div>",{id:"telInfo-"+t,"class":"imgTelecInfo",style:"left : "+xm1+"px;top : "+ym1+"px;"}).appendTo("#telec-"+t),$("<img>",{src:"panovisu/images/telecommande/info.png",border:"0",width:e,alt:"",title:chainesTraduction[mr].info}).appendTo("#telInfo-"+t)),n+=1),"oui"===os&&(Hs[n]&&(xm1=Hs[n].centerX-e/2-i,ym1=Hs[n].centerY-e/2-i,$("<div>",{id:"telAide-"+t,"class":"imgTelecInfo",style:"left : "+xm1+"px;top : "+ym1+"px;"}).appendTo("#telec-"+t),$("<img>",{src:"panovisu/images/telecommande/aide.png",border:"0",width:e,alt:"",title:chainesTraduction[mr].aide}).appendTo("#telAide-"+t)),n+=1),"oui"===es&&(Hs[n]&&(xm1=Hs[n].centerX-e/2-i,ym1=Hs[n].centerY-e/2-i,$("<div>",{id:"telFS-"+t,"class":"imgTelecFS",style:"left : "+xm1+"px;top : "+ym1+"px;"}).appendTo("#telec-"+t),$("<img>",{src:"panovisu/images/telecommande/fs.png",border:"0",width:e,alt:"",title:chainesTraduction[mr].pleinEcran}).appendTo("#telFS-"+t)),n+=1),"oui"===is&&(Hs[n]&&(xm1=Hs[n].centerX-e/2-i,ym1=Hs[n].centerY-e/2-i,$("<div>",{id:"telRotation-"+t,"class":"imgTelecFS",style:"left : "+xm1+"px;top : "+ym1+"px;"}).appendTo("#telec-"+t),$("<img>",{src:"panovisu/images/telecommande/rotation.png",border:"0",width:e,alt:"",title:chainesTraduction[mr].autorotation}).appendTo("#telRotation-"+t)),n+=1),"oui"===ns&&(Hs[n]&&(xm1=Hs[n].centerX-e/2-i,ym1=Hs[n].centerY-e/2-i,$("<div>",{id:"telSouris-"+t,"class":"imgTelecFS",style:"left : "+xm1+"px;top : "+ym1+"px;"}).appendTo("#telec-"+t),$("<img>",{src:"panovisu/images/telecommande/souris.png",border:"0",width:e,alt:"",title:chainesTraduction[mr].souris}).appendTo("#telSouris-"+t)),n+=1),$("<map>",{id:"telecommandeMap-"+t,name:"telecommandeMap-"+t}).appendTo("#telec-"+t),Se=0;Se<Ys.length;Se++){switch(Ys[Se].id){case"telUp":Ys[Se].title=chainesTraduction[mr].haut;break;case"telDown":Ys[Se].title=chainesTraduction[mr].bas;break;case"telRight":Ys[Se].title=chainesTraduction[mr].droite;break;case"telLeft":Ys[Se].title=chainesTraduction[mr].gauche;break;case"telZoomPlus":Ys[Se].title=chainesTraduction[mr].zoomPlus;break;case"telZoomMoins":Ys[Se].title=chainesTraduction[mr].zoomMoins;break;case"telInfo":Ys[Se].title=chainesTraduction[mr].info;break;case"telAide":Ys[Se].title=chainesTraduction[mr].aide;break;case"telFS":Ys[Se].title=chainesTraduction[mr].pleinEcran;break;case"telRotation":Ys[Se].title=chainesTraduction[mr].autorotation;break;case"telSouris":Ys[Se].title=chainesTraduction[mr].souris;break;case"telLien-1":Ys[Se].title=ds;break;case"telLien-2":Ys[Se].title=hs}$("<area>",{id:Ys[Se].id+"-"+t,"class":"clicTelec",alt:"",title:Ys[Se].title,shape:Ys[Se].shape,coords:Ys[Se].coords,style:"outline:none;",target:"_self"}).appendTo("#telecommandeMap-"+t)}switch(trX="50%",trY="50%",ss){case"left":trX="0%";break;case"right":trX="100%"}switch(rs){case"top":trY="0%";break;case"bottom":trY="100%"}$("#telec-"+t).css({transformOrigin:trX+" "+trY,transform:"scale("+us/100+","+us/100+")"}),"center"===ss&&$("#telec-"+t).css("left",(ua.width()-$("#telec-"+t).width())/2+cs+"px")}))}function me(){$("#comboMenu-"+t).html(""),fs&&($("#comboMenu-"+t).css(ms,vs+"px"),$("#comboMenu-"+t).css($s,xs+"px"),$("<select>",{id:"cbMenu-"+t,"class":"cbMenu",style:"left : 0px;width : 300px;"}).appendTo("#comboMenu-"+t),As.forEach(function(e){attrib="selected"===e.select?"selected":"not-selected",$("#cbMenu-"+t).append(""!==e.image?$("<option>",{value:e.xml}).attr("data-image",e.image).attr("data-description",e.sousTitre).attr(attrib,e.select).text(e.titre):$("<option>",{value:e.xml}).attr("data-description",e.sousTitre).attr(attrib,e.select).text(e.titre))}),$("#cbMenu-"+t).msDropdown({visibleRows:4}),$("#cbMenu-"+t).on("change",function(){var e=this.value;$("#container-"+t).fadeOut(500,function(){$e(e)})}))}function $e(e){ks=!0,clearInterval(ai),Ds=0,qs=0,Qs=50,Fs=!0,le(),Xs=new Array,Es=new Array,Vs=0,$("#divVignettes-"+t).html(""),$("#infoBulle-"+t).html(""),he(e)}function ve(t,e,i,n,a,o,s,r,c){Zi.styleMap=new OpenLayers.StyleMap({"default":{strokeWidth:1,fillColor:s,fillOpacity:c,strokeColor:r}});var p=2*Math.abs(a-n),u=[];o&&u.push(new OpenLayers.Geometry.Point(t,e));for(var l=p+1,d=0;l>d;d++){var h=n-(n-a)*d/(l-1),g=t+i*Math.cos(h*Math.PI/180),f=e+i*Math.sin(h*Math.PI/180),m=new OpenLayers.Geometry.Point(g,f);u.push(m)}var $=null;if(o){var v=new OpenLayers.Geometry.LinearRing(u);$=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.Polygon(v))}else $=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.LineString(u));return $}function xe(t,e,i){var n=be(t),a=we(e);Di.setCenter(new OpenLayers.LonLat(n,a),i)}function be(t){return 20037508.34*t/180}function we(t){var e=3.141592653589793;return t=Math.log(Math.tan((90+t)*e/360))/(e/180),20037508.34*t/180}function Te(e,i,n,a){e>yr&&(yr=e);var o,s,r=Ui,c=new OpenLayers.LonLat(be(i),we(n)),p=new OpenLayers.Size(24,27),u=new OpenLayers.Pixel(-(p.w/2),-p.h);"actif"===Mr[e].xml?(s=new OpenLayers.Icon("./panovisu/images/marqueursOL/marqueurActif.png",p,u),Di.setCenter(c)):s=new OpenLayers.Icon("./panovisu/images/marqueursOL/marqueur.png",p,u);var l=new OpenLayers.Marker(c,s);l.setOpacity("actif"!==Mr[e].xml?.8:1),l.events.register("mouseover",l,function(){"actif"!==Mr[e].xml&&(o=new OpenLayers.Popup("marq"+e,new OpenLayers.LonLat(be(i),we(n)),new OpenLayers.Size(250,150),a,!0),Di.addPopup(o)),this.setOpacity(1)}),l.events.register("mouseout",l,function(){"actif"!==Mr[e].xml&&Di.removePopup(o),l.setOpacity("actif"!==Mr[e].xml?.8:1)}),l.events.register("mousedown",l,function(){"actif"!==Mr[e].xml&&(Di.removePopup(o),$("#container-"+t).fadeOut(200,function(){$e(Mr[e].xml)}))}),r.addMarker(l),Tr[e]=l}function ye(){for(var t=0;yr>=t;t++){var e=Tr[t];null!==e&&Ui.removeMarker(e)}}function Pe(t){for(var e=0;e<Di.getNumLayers();e++)Di.layers[e].name===t&&Di.setBaseLayer(Di.layers[e])}function Ie(t){null===xr&&(xr=new OpenLayers.Layer.Bing({name:"Bing",type:"Road",key:t,zoomOffset:10,resolutions:Vr,numZoomLevels:19,transitionEffect:"resize"}),br=new OpenLayers.Layer.Bing({name:"Bing Hybride",type:"AerialWithLabels",key:t,zoomOffset:10,resolutions:Vr,numZoomLevels:19,transitionEffect:"resize"}),wr=new OpenLayers.Layer.Bing({name:"Bing Satellite",type:"Aerial",key:t,zoomOffset:10,resolutions:Vr,numZoomLevels:19,transitionEffect:"resize"}),Di.addLayers([xr,br,wr]))}function Le(){Zi.destroyFeatures();var t=Wi.pcRayon/100*Math.min(Di.getExtent().right-Di.getExtent().left,Di.getExtent().top-Di.getExtent().bottom)/2,e=Wi.angleradar-Wi.angleOuverture/2,i=Wi.angleradar+Wi.angleOuverture/2,n=be(Wi.longitude),a=we(Wi.latitude),o=ve(n,a,t,e,i,!0,Wi.couleurLigne,Wi.couleurFond,Wi.opaciteFond),s=new OpenLayers.Geometry.Point(n,a),r={strokeColor:"#999999",strokeOpacity:1,fillColor:"#555555",strokeWidth:1,pointRadius:5,pointerEvents:"visiblePainted"},c=new OpenLayers.Feature.Vector(s,null,r);Zi.addFeatures([o,c])}function Me(t){Wi=new c,OpenLayers.Lang.setCode("fr"),Di=new OpenLayers.Map(t,{projection:new OpenLayers.Projection("EPSG:900913"),displayProjection:new OpenLayers.Projection("EPSG:4326"),controls:[new OpenLayers.Control.Navigation,new OpenLayers.Control.PanZoomBar,new OpenLayers.Control.ScaleLine,new OpenLayers.Control.MousePosition,new OpenLayers.Control.LayerSwitcher],maxExtent:new OpenLayers.Bounds(-20037508.34,-20037508.34,20037508.34,20037508.34),maxResolution:156543,lang:"fr",units:"meters"}),qi=new OpenLayers.Layer.OSM.Mapnik("OpenStreetMap",{zoomOffset:10,resolutions:Vr,numZoomLevels:20,transitionEffect:"resize"}),Ui=new OpenLayers.Layer.Markers("Adresse",{projection:new OpenLayers.Projection("EPSG:900913"),visibility:!0,displayInLayerSwitcher:!1}),Zi=Fe("none","red",.4,35),Di.addLayers([qi,Zi,Ui]),Di.autoUpdateSize=!1,Bi=new OpenLayers.Layer.Google("Google",{minZoomLevel:10,maxZoomLevel:20,transitionEffect:"resize"}),ji=new OpenLayers.Layer.Google("Google Physique",{type:google.maps.MapTypeId.TERRAIN,minZoomLevel:10,maxZoomLevel:16,transitionEffect:"resize"}),Gi=new OpenLayers.Layer.Google("Google Hybride",{type:google.maps.MapTypeId.HYBRID,minZoomLevel:10,maxZoomLevel:20,transitionEffect:"resize"}),_i=new OpenLayers.Layer.Google("Google Satellite",{type:google.maps.MapTypeId.SATELLITE,minZoomLevel:10,maxZoomLevel:20,transitionEffect:"resize"}),Di.addLayers([ji,Bi,Gi,_i]),Di.events.register("move",Di,function(){Pr&&Le()}),Di.events.register("zoomend",Di,function(){Pr&&Le()})}function Ve(t,e,i,n,a,o,s,r){o=o||"yellow",s=s||"green",r=r||.2,Wi.longitude=t,Wi.latitude=e,Wi.angleOuverture=i,Wi.angleradar=n,Wi.pcRayon=a,Wi.couleurLigne=o,Wi.couleurFond=s,Wi.opaciteFond=r,Le(),Pr=!0}function ke(t,e){Pr&&(Wi.angleOuverture=e,Wi.angleradar=t,Le())}function Fe(t,e,i,n){var a=new OpenLayers.Layer.Vector("Radar",{displayInLayerSwitcher:!1});return a.styleMap=new OpenLayers.StyleMap({"default":{strokeWidth:1,strokeColor:t,fillColor:e,fillOpacity:i}}),a.rayon=n,a}function Xe(t){null===Oi&&(Oi=t);var e=(t-Oi)/1e3;fr++,Qs=Ai+Si*e/Yi,E(),Yi>e&&!Fi&&requestAnimFrame(Xe)}function Ee(t){null===Oi&&(Oi=t);var e=(t-Oi)/1e3;fr++,Ds=Ei+Xi*e/Yi,qs=Ri+Hi*e/Yi,k(),Yi>e&&!Fi&&requestAnimFrame(Ee)}var Re=window.location.search.substring(1).split("&"),Ae=[];for(var Se in Re)-1!==Re[Se].indexOf("=")?Ae[decodeURI(Re[Se].substring(0,Re[Se].indexOf("=")))]=decodeURI(Re[Se].substring(Re[Se].indexOf("=")+1)):Ae[decodeURI(Re[Se])]="";var Oe,Ye,He,Ce=[],ze=[],De=[],qe=[],Be=0,Ge=0,je=0,_e=0;Date.now||(Date.now=function(){return(new Date).getTime()});var Ue,Ze,We,Ne,Ke,Je,Qe,ti,ei,ii,ni,ai,Se,oi,si,ri,ci,pi,ui,li,di,hi,gi,fi,mi,$i,vi,xi,bi,wi,Ti,yi,Pi,Ii,Li,Mi,Vi,ki,Fi,Xi,Ei,Ri,Ai,Si,Oi,Yi,Hi,Ci,zi,Di,qi,Bi,Gi,ji,_i,Ui,Zi,Wi,Ni,Ki,Ji,Qi,tn,en,nn,an,on,sn,rn,cn,pn,un,ln,dn,hn,gn,fn,mn,$n,vn,xn,bn,wn,Tn,yn,Pn,In,Ln,Mn,Vn,kn,Fn,Xn,En,Rn,An,Sn,On,Yn,Hn,Cn,zn,Dn,qn,Bn,Gn,jn,_n,Un,Zn,Wn,Nn,Kn,Jn,Qn,ta,ea,ia,na,aa,oa,sa,ra,ca,pa,ua,la,da,ha,ga,fa,ma,$a,va,xa,ba,wa,Ta,ya,Pa,Ia,La,Ma,Va,ka,Fa,Xa,Ea,Ra,Aa,Sa,Oa,Ya,Ha,Ca,za,Da,qa,Ba,Ga,ja,_a,Ua,Za,Wa,Na,Ka,Ja,Qa,to,eo,io,no,ao,oo,so,ro,co,po,uo,lo,ho,go,fo,mo,$o,vo,xo,bo,wo,To,yo,Po,Io,Lo,Mo,Vo,ko,Fo,Xo,Eo,Ro,Ao,So,Oo,Yo,Ho,Co,zo,Do,qo,Bo,Go,jo,_o,Uo,Zo,Wo,No,Ko,Jo,Qo,ts,es,is,ns,as,os,ss,rs,cs,ps,us,ls,ds,hs,gs,fs,ms,$s,vs,xs,bs=!1,ws=!1,Ts=0,ys=0,Ps=null,Is=!1,Ls=!1,Ms=!0,Vs=0,ks=!1,Fs=!1,Xs=new Array,Es=new Array,Rs=new Array,As=new Array,Ss=new Array,Os=new Array,Ys=new Array,Hs=new Array,Cs=0,zs=1,Ds=0,qs=0,Bs="",Gs=!1,js=0,_s=0,Us=0,Zs=0,Ws=0,Ns=0,Ks=0,Js=0,Qs=50,tr=0,er=0,ir=0,nr=0,ar=125,or=25,sr=new THREE.Vector3,rr=!1,cr=0,pr=0,ur=0,lr=!1,dr=!0,hr="",gr=!1,fr=0,mr="fr_FR",$r=!1,vr=Math.PI/180,xr=null,br=null,wr=null,Tr=new Array,yr=-1,Pr=!1,Ir="rgba(255,255,255,0)",Lr="rgba(255,255,255,0)",Mr=new Array;$(document).on("webkitfullscreenchange mozfullscreenchange fullscreenchange MSFullscreenChange",function(){rr=!rr,ne()}),$(document).on("touchstart click",".hotSpots",function(e){switch(e.preventDefault(),idHS=$(this).attr("id"),oi=parseInt(idHS.split("-")[1]),Es[oi].type){case"panoramique":$("#container-"+t).fadeOut(200,function(){S(oi)});break;case"image":F(Es[oi].contenu);break;case"html":X(oi)}}),$(document).on("click","#container-"+t,function(){si=!1}),$(document).on("mousedown","#container-"+t,function(e){1===e.which&&(_n&&$("#infoPanovisu-"+t).fadeOut(2e3,function(){$(this).css({display:"none"}),_n=!1}),js=e.clientX,_s=e.clientY,Gs=!0,1===zs?(ir=0,nr=0,Ke=requestAnimFrame(L)):(Ws=Ds,Ns=qs,ua.addClass("curseurCroix"),0===zs&&$("#container-"+t).css("cursor","grabbing"))),e.preventDefault()}),$(document).on("mousemove","#container-"+t,function(t){Gs===!0&&(si=!0,1===zs?(ir=.01*-(js-t.clientX),nr=.01*(_s-t.clientY)):(de(),Ds=.1*(js-t.clientX)+Ws,qs=.1*(t.clientY-_s)+Ns,k())),t.preventDefault()}),$(document).on("mouseup","#container-"+t,function(){ua.removeClass("curseurCroix"),0===zs?$("#container-"+t).css("cursor","grab"):Gs&&(Je=ir,Qe=nr,tr=ir/4,er=nr/4,Ke=requestAnimFrame(h)),Gs=!1}),$(window).on("mouseup",function(){ua.removeClass("curseurCroix"),0===zs?$("#container-"+t).css("cursor","grab"):Gs&&(Je=ir,Qe=nr,tr=ir/4,er=nr/4,Ke=requestAnimFrame(h)),Gs=!1}),$(document).on("mouseover","#panovisu-"+t,function(){$r=!0}),$(document).on("mouseleave","#panovisu-"+t,function(){$r=!1}),$(document).on("mousewheel","#container-"+t,function(e,i){_n&&$("#infoPanovisu-"+t).fadeOut(2e3,function(){$(this).css({display:"none"}),_n=!1}),e.preventDefault(),Qs-=i,E()}),$(window).resize(function(){ne()}),$(document).keydown(function(e){_n&&$("#infoPanovisu-"+t).fadeOut(2e3,function(){$(this).css({display:"none"}),_n=!1}),e.preventDefault();var i=e.which;switch(i){case 37:Ds-=1;break;case 38:qs+=1;break;case 39:Ds+=1;break;case 40:qs-=1;break;case 16:Qs+=1;break;case 17:Qs-=1;break;case 70:O();break;case 86:ui=!ui,I();break;case 80:ri=!ri,"left"===lo?w():T();break;case 77:x()}E()}),$(document).on("touchstart mousedown","#xmoins-"+t+",#xplus-"+t+",#ymoins-"+t+",#yplus-"+t,function(e){_n&&$("#infoPanovisu-"+t).fadeOut(2e3,function(){$(this).css({display:"none"}),_n=!1}),ti=!0,p($(this).attr("id")),Je=tr/5,Qe=er/5,Ke=requestAnimFrame(d),e.preventDefault()}),$(document).on("touchend mouseup mouseleave","#xmoins-"+t+",#xplus-"+t+",#ymoins-"+t+",#yplus-"+t,function(t){ti&&(t.stopPropagation(),ti=!1,Ke=requestAnimFrame(h),t.preventDefault())}),$(document).on("touchstart mousedown","#zoomPlus-"+t,function(e){_n&&$("#infoPanovisu-"+t).fadeOut(2e3,function(){$(this).css({display:"none"}),_n=!1}),ti=!0,Ke=requestAnimFrame(l),e.preventDefault()}),$(document).on("touchend mouseup mouseleave","#zoomPlus-"+t,function(t){ti=!1,t.preventDefault()}),$(document).on("click","#zoomMoins-"+t,function(e){_n&&$("#infoPanovisu-"+t).fadeOut(2e3,function(){$(this).css({display:"none"}),_n=!1}),Qs+=1,E(),e.preventDefault()}),$(document).on("touchstart mousedown","#zoomMoins-"+t,function(e){_n&&$("#infoPanovisu-"+t).fadeOut(2e3,function(){$(this).css({display:"none"}),_n=!1}),ti=!0,Ke=requestAnimFrame(u),e.preventDefault()}),$(document).on("touchend mouseup mouseleave","#zoomMoins-"+t,function(t){ti=!1,t.preventDefault()}),$(document).on("click","#xmoins-"+t+",#xplus-"+t+",#ymoins-"+t+",#yplus-"+t,function(){_n&&$("#infoPanovisu-"+t).fadeOut(2e3,function(){$(this).css({display:"none"}),_n=!1}),p($(this).attr("class")),Ds+=2*tr,qs+=2*er,k()}),$(document).on("click","#zoomPlus-"+t,function(e){_n&&$("#infoPanovisu-"+t).fadeOut(2e3,function(){$(this).css({display:"none"}),_n=!1}),Qs-=1,E(),e.preventDefault()}),$(document).on("click","#souris-"+t,function(){g()}),$(document).on("click","#pleinEcran-"+t,function(){O()}),$(document).on("click","#auto-"+t,function(){f()}),$(document).on("click",".binfo",function(){m()}),$(document).on("click",".aide",function(){v()}),$(document).on("click",".infoPanovisu",function(){$(this).fadeOut(2e3,function(){$(this).css({display:"none"}),_n=!1})}),$(document).on("click",".aidePanovisu",function(){$(this).fadeOut(2e3,function(){$(this).css({display:"none"}),Un=!1})}),$(document).on("click",".infoPanovisu a",function(t){t.stopPropagation()}),$(document).on("click",".imgVignette",function(){if(0!==Rs.length){var e=$(this).attr("id"),i=parseInt(e.substring(6).split("-")[0]);fi=Rs[i].xml,$("#container-"+t).fadeOut(200,function(){$e(fi)})}}),$(document).on("click",".positionVignettes",function(e){ro&&(e.stopPropagation(),element=$(this).attr("id"),(element==="gaucheVignettes-"+t||element==="droiteVignettes-"+t)&&(deplace=ro+10,element==="gaucheVignettes-"+t?pr+=deplace:pr-=deplace,pr>0&&(pr=0),-pr+$("#divVignettes-"+t).width()>(ro+10)*Rs.length&&(pr=$("#divVignettes-"+t).width()-(ro+10)*Rs.length),$("#vignettes-"+t).css({transform:"translate("+pr+"px,0px)"})),(element==="basVignettes-"+t||element==="hautVignettes-"+t)&&(deplace=ro/2+5,element==="hautVignettes-"+t?ur+=deplace:ur-=deplace,ur>0&&(ur=0),-ur+$("#divVignettes-"+t).height()>(ro/2+15)*Rs.length&&(ur=$("#divVignettes-"+t).height()-(ro/2+15)*Rs.length),$("#vignettes-"+t).css({transform:"translate(0px,"+ur+"px)"})),_n&&$("#infoPanovisu-"+t).fadeOut(2e3,function(){$(this).css({display:"none"}),_n=!1}))}),$(document).on("click",".marcheArret",function(t){t.stopPropagation(),x()}),$(document).on("click","#divSuivant-"+t,function(){$("#container-"+t).fadeOut(200,function(){$e(Qi)})}),$(document).on("click","#divPrecedent-"+t,function(){$("#container-"+t).fadeOut(500,function(){$e(tn)})}),$(document).on("click","#planTitre-"+t,function(){"left"===lo?(ri=ri?!1:!0,w()):(ri=ri?!1:!0,T())}),$(document).on("click","#carteTitre-"+t,function(){"left"===Mo?(ci=ci?!1:!0,y()):(ci=ci?!1:!0,P())}),$(document).on("click",".titreVignettes",function(){ui=ui?!1:!0,I()}),$(document).on("click",".planPoint",function(){if(0!==Ss.length){var e=parseInt($(this).attr("id").split("-")[1]);fi=Ss[e].xml,"actif"!==fi&&$("#container-"+t).fadeOut(200,function(){$e(fi)})}}),$(document).on("click","#imgFerme-"+t,function(){$("#divHTML-"+t).hide(),$("#divImage-"+t).hide()}),$(document).on("click","#homeCarte-"+t,function(){"Google"===qo.substring(0,6)?xe(zo,Do,Co):xe(zo,Do,Co-10)}),$(document).on("click",".clicTelec,.imgTelecFS,.imgTelecInfo",function(e){switch(ti=!0,_n&&$("#infoPanovisu-"+t).fadeOut(2e3,function(){$(this).css({display:"none"}),_n=!1}),idClic=$(this).attr("id"),sens="",sensZoom="",idClic){case"telUp-"+t:sens="ymoins";break;case"telDown-"+t:sens="yplus";break;case"telRight-"+t:sens="xplus";break;case"telLeft-"+t:sens="xmoins";break;case"telZoomMoins-"+t:Qs+=2,E();break;case"telZoomPlus-"+t:Qs-=2,E();break;case"telInfo-"+t:m();break;case"telAide-"+t:v();break;case"telFS-"+t:O();break;case"telSouris-"+t:g();break;case"telRotation-"+t:f();break;case"telLien-1-"+t:window.open(ds);break;case"telLien-2-"+t:window.open(hs)}""!==sens&&(p(sens),Ds+=2*tr,qs+=2*er,k()),e.stopPropagation(),e.preventDefault()}),$(document).on("touchstart mousedown",".clicTelec",function(e){switch(ti=!0,Is=!1,_n&&$("#infoPanovisu-"+t).fadeOut(2e3,function(){$(this).css({display:"none"}),_n=!1}),idClic=$(this).attr("id"),sens="",sensZoom="",idClic){case"telUp-"+t:sens="ymoins";break;case"telDown-"+t:sens="yplus";break;case"telRight-"+t:sens="xplus";break;case"telLeft-"+t:sens="xmoins";break;case"telZoomMoins-"+t:Ke=requestAnimFrame(u);break;case"telZoomPlus-"+t:Ke=requestAnimFrame(l)}""!==sens&&(Is=!0,p(sens),Je=tr/5,Qe=er/5,Ke=requestAnimFrame(d)),e.stopPropagation(),e.preventDefault()}),$(document).on("touchend mouseup mouseleave",".clicTelec",function(t){ti&&(t.stopPropagation(),ti=!1,cancelAnimationFrame(Ke),Is&&(Ke=requestAnimFrame(h)),t.preventDefault())}),$(document).on("touchstart click",".btnVisiteAuto",function(t){t.preventDefault(),An?(An=!1,Ls=!1,G()):(An=!0,Ls=!0,B())}),this.initialisePano=function(t){var e={langue:"fr_FR",xml:"xml/panovisu.xml",fenX:"75%",fenY:"80%",panoramique:"panovisu",minFOV:35,maxFOV:120};ya=!0,t=$.extend(e,t),li=t.panoramique,mr=t.langue,$("#"+li).css("overflow","hidden"),ar=t.maxFOV,or=t.minFOV;var i=li;$(i).css({overflow:"hidden"}),ge(i),fi=Ae.xml||t.xml,t.fenX.match("[px]","g")?(vi="px",mi=parseInt(t.fenX)):(vi="%",mi=parseInt(t.fenX)/100),t.fenY.match("[px]","g")?(xi="px",$i=parseInt(t.fenY)):(xi="%",$i=parseInt(t.fenY)/100),estTactile()&&(zs=0),he(fi)};var Vr=OpenLayers.Layer.Bing.prototype.serverResolutions.slice(10,20);this.allerFOV=function(e,i){Fi=!1,Oi=null,Yi=i||2,_n&&$("#infoPanovisu-"+t).fadeOut(200,function(){$(this).css({display:"none"}),_n=!1}),Ai=Qs,Si=e-Qs,requestAnimFrame(Xe)},this.setFOV=function(e){_n&&$("#infoPanovisu-"+t).fadeOut(2e3,function(){$(this).css({display:"none"}),_n=!1}),Qs=e,E()},this.getFOV=function(){return Qs},this.setLongitude=function(e){_n&&$("#infoPanovisu-"+t).fadeOut(2e3,function(){$(this).css({display:"none"}),_n=!1}),Ds=e,k()},this.getLongitude=function(){return Ds},this.setLatitude=function(e){_n&&$("#infoPanovisu-"+t).fadeOut(2e3,function(){$(this).css({display:"none"}),_n=!1}),qs=e,k()},this.getLatitude=function(){return qs},this.setPoint=function(e,i){_n&&$("#infoPanovisu-"+t).fadeOut(2e3,function(){$(this).css({display:"none"}),_n=!1}),Ds=e,qs=i,k()},this.allerAuPoint=function(e,i,n){Fi=!1,Oi=null,Yi=n||2,_n&&$("#infoPanovisu-"+t).fadeOut(200,function(){$(this).css({display:"none"}),_n=!1}),Ds%=360,0>Ds&&(Ds+=360),Ei=Ds,Xi=e-Ds,Ri=qs,Hi=i-qs,requestAnimFrame(Ee)},this.setPano=function(e){$("#container-"+t).fadeOut(200,function(){$e(e)})},this.stopMouvement=function(){Fi=!0},this.getXML=function(){return Bs}}$("head").append($(document.createElement("link")).attr({rel:"stylesheet",type:"text/css",href:"panovisu/css/panovisu.css",media:"screen"})),supportWebgl()||supportCanvas()||alert("Navigateur non supporté");